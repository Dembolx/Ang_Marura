<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Matura Angielski ‚Äî Trener</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0e12;
    --surface: #13151c;
    --surface2: #1c1f2a;
    --border: #2a2d3a;
    --accent: #e8c547;
    --accent2: #4fc3f7;
    --accent3: #f06292;
    --text: #e8eaf0;
    --text-muted: #6b7080;
    --success: #66bb6a;
    --error: #ef5350;
    --warn: #ffa726;
    --radius: 12px;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Background grain */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
  }

  header {
    position: sticky; top: 0; z-index: 100;
    background: rgba(13,14,18,0.9);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
    padding: 0 2rem;
    display: flex; align-items: center; justify-content: space-between;
    height: 64px;
  }
  .logo {
    font-family: 'Playfair Display', serif;
    font-size: 1.4rem;
    color: var(--accent);
    letter-spacing: -0.5px;
  }
  .logo span { color: var(--text-muted); font-size: 0.85rem; font-family: 'DM Mono', monospace; display: block; margin-top: -4px; }

  nav { display: flex; gap: 0.5rem; }
  .nav-btn {
    background: none; border: none; color: var(--text-muted);
    font-family: 'DM Sans', sans-serif; font-size: 0.85rem;
    padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer;
    transition: all 0.2s;
  }
  .nav-btn:hover, .nav-btn.active { background: var(--surface2); color: var(--accent); }

  main { position: relative; z-index: 1; max-width: 960px; margin: 0 auto; padding: 2rem 1.5rem; }

  /* === VIEWS === */
  .view { display: none; }
  .view.active { display: block; }

  /* === HOME === */
  .hero { text-align: center; padding: 3rem 0 2rem; }
  .hero h1 { font-family: 'Playfair Display', serif; font-size: clamp(2rem, 5vw, 3.5rem); line-height: 1.1; margin-bottom: 0.75rem; }
  .hero h1 em { color: var(--accent); font-style: normal; }
  .hero p { color: var(--text-muted); font-size: 1.05rem; margin-bottom: 2.5rem; }

  .stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2.5rem; }
  .stat-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1.25rem;
    text-align: center;
    transition: border-color 0.2s;
  }
  .stat-card:hover { border-color: var(--accent); }
  .stat-card .val {
    font-family: 'Playfair Display', serif;
    font-size: 2rem; font-weight: 700;
    color: var(--accent);
    display: block;
  }
  .stat-card .lbl { font-size: 0.78rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }

  .categories-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 1rem; }
  .cat-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
    overflow: hidden;
  }
  .cat-card::before {
    content: '';
    position: absolute; inset: 0;
    background: linear-gradient(135deg, var(--cat-color, #e8c547) 0%, transparent 60%);
    opacity: 0.05;
    transition: opacity 0.2s;
  }
  .cat-card:hover { border-color: var(--cat-color, var(--accent)); transform: translateY(-2px); }
  .cat-card:hover::before { opacity: 0.1; }
  .cat-icon { font-size: 2rem; margin-bottom: 0.75rem; }
  .cat-name { font-weight: 600; font-size: 1.05rem; margin-bottom: 0.25rem; }
  .cat-desc { font-size: 0.82rem; color: var(--text-muted); margin-bottom: 1rem; }
  .cat-progress { height: 4px; background: var(--border); border-radius: 2px; overflow: hidden; }
  .cat-progress-fill { height: 100%; background: var(--cat-color, var(--accent)); border-radius: 2px; transition: width 0.5s; }
  .cat-stats { display: flex; gap: 1rem; margin-top: 0.75rem; font-size: 0.78rem; color: var(--text-muted); }

  /* === EXERCISE VIEW === */
  .ex-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem; }
  .back-btn {
    background: var(--surface); border: 1px solid var(--border);
    color: var(--text); padding: 0.5rem 1rem; border-radius: 8px;
    cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 0.85rem;
    transition: all 0.2s;
  }
  .back-btn:hover { border-color: var(--accent); color: var(--accent); }
  .ex-category-badge {
    font-family: 'DM Mono', monospace; font-size: 0.78rem;
    padding: 0.3rem 0.8rem; border-radius: 20px;
    background: var(--surface2); border: 1px solid var(--border);
    color: var(--text-muted);
  }
  .ex-progress-bar { flex: 1; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; }
  .ex-progress-fill { height: 100%; background: var(--accent); border-radius: 3px; transition: width 0.4s; }
  .ex-counter { font-family: 'DM Mono', monospace; font-size: 0.85rem; color: var(--text-muted); white-space: nowrap; }

  .exercise-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 2rem;
    margin-bottom: 1.5rem;
    animation: slideIn 0.3s ease;
  }
  @keyframes slideIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: none; } }

  .ex-type-badge {
    display: inline-block;
    font-family: 'DM Mono', monospace; font-size: 0.72rem;
    padding: 0.25rem 0.6rem; border-radius: 4px;
    background: var(--surface2); color: var(--accent2);
    border: 1px solid var(--border);
    margin-bottom: 1rem;
    text-transform: uppercase; letter-spacing: 0.5px;
  }
  .ex-instruction { font-size: 0.88rem; color: var(--text-muted); margin-bottom: 0.5rem; font-style: italic; }
  .ex-text {
    font-size: 1rem; line-height: 1.75;
    margin-bottom: 1.5rem;
    padding: 1rem 1.25rem;
    background: var(--surface2);
    border-radius: 8px;
    border-left: 3px solid var(--accent2);
  }
  .ex-question { font-size: 1.05rem; font-weight: 500; margin-bottom: 1.25rem; line-height: 1.6; }

  /* Options */
  .options { display: flex; flex-direction: column; gap: 0.6rem; }
  .option-btn {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 0.85rem 1.1rem;
    border-radius: 8px;
    cursor: pointer;
    text-align: left;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.95rem;
    transition: all 0.15s;
    display: flex; align-items: center; gap: 0.75rem;
  }
  .option-btn:hover:not(:disabled) { border-color: var(--accent); background: rgba(232,197,71,0.06); }
  .option-btn .opt-letter {
    font-family: 'DM Mono', monospace; font-size: 0.8rem;
    width: 24px; height: 24px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 50%;
    background: var(--border);
    color: var(--text-muted);
    flex-shrink: 0;
  }
  .option-btn.correct { border-color: var(--success); background: rgba(102,187,106,0.1); }
  .option-btn.correct .opt-letter { background: var(--success); color: #000; }
  .option-btn.wrong { border-color: var(--error); background: rgba(239,83,80,0.1); }
  .option-btn.wrong .opt-letter { background: var(--error); color: #fff; }
  .option-btn:disabled { cursor: default; opacity: 0.7; }

  /* Input types */
  .ex-input {
    width: 100%; padding: 0.85rem 1.1rem;
    background: var(--surface2); border: 1px solid var(--border);
    border-radius: 8px; color: var(--text);
    font-family: 'DM Mono', monospace; font-size: 0.95rem;
    transition: border-color 0.2s;
    outline: none;
  }
  .ex-input:focus { border-color: var(--accent2); }
  .ex-input.correct { border-color: var(--success); }
  .ex-input.wrong { border-color: var(--error); }

  textarea.ex-input { resize: vertical; min-height: 140px; line-height: 1.6; font-family: 'DM Sans', sans-serif; }

  .fill-blanks { display: flex; flex-direction: column; gap: 0.75rem; }
  .blank-row { display: flex; align-items: center; gap: 0.75rem; font-size: 0.95rem; }
  .blank-num { font-family: 'DM Mono', monospace; font-size: 0.78rem; color: var(--accent); min-width: 28px; }
  .blank-input {
    background: var(--surface2); border: 1px solid var(--border);
    border-radius: 6px; color: var(--text);
    font-family: 'DM Mono', monospace; font-size: 0.95rem;
    padding: 0.5rem 0.75rem; outline: none;
    transition: border-color 0.2s; min-width: 180px;
  }
  .blank-input:focus { border-color: var(--accent2); }
  .blank-input.correct { border-color: var(--success); }
  .blank-input.wrong { border-color: var(--error); }
  .blank-hint { font-size: 0.82rem; color: var(--text-muted); }

  /* Feedback */
  .feedback-box {
    padding: 1rem 1.25rem;
    border-radius: 8px;
    margin-top: 1.25rem;
    font-size: 0.92rem;
    line-height: 1.6;
    display: none;
    animation: fadeIn 0.2s ease;
  }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  .feedback-box.correct { background: rgba(102,187,106,0.1); border: 1px solid rgba(102,187,106,0.3); color: var(--success); }
  .feedback-box.wrong { background: rgba(239,83,80,0.1); border: 1px solid rgba(239,83,80,0.3); color: #ff8a80; }
  .feedback-box strong { display: block; margin-bottom: 0.25rem; }

  .action-row { display: flex; gap: 0.75rem; margin-top: 1.25rem; justify-content: flex-end; }
  .btn {
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-family: 'DM Sans', sans-serif; font-size: 0.92rem; font-weight: 500;
    cursor: pointer; border: none; transition: all 0.2s;
  }
  .btn-primary { background: var(--accent); color: #000; }
  .btn-primary:hover { background: #f0d060; }
  .btn-secondary { background: var(--surface2); color: var(--text); border: 1px solid var(--border); }
  .btn-secondary:hover { border-color: var(--accent); color: var(--accent); }
  .btn:disabled { opacity: 0.4; cursor: default; }

  /* === STATS VIEW === */
  .stats-section { margin-bottom: 2.5rem; }
  .stats-section h2 {
    font-family: 'Playfair Display', serif; font-size: 1.6rem;
    margin-bottom: 1.25rem; padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--border);
  }
  .chart-bars { display: flex; flex-direction: column; gap: 0.75rem; }
  .chart-row { display: flex; align-items: center; gap: 1rem; }
  .chart-label { font-size: 0.85rem; min-width: 160px; color: var(--text-muted); }
  .chart-bar-wrap { flex: 1; height: 28px; background: var(--surface2); border-radius: 6px; overflow: hidden; position: relative; }
  .chart-bar { height: 100%; border-radius: 6px; transition: width 0.8s ease; display: flex; align-items: center; padding-left: 0.75rem; font-size: 0.78rem; font-family: 'DM Mono', monospace; color: rgba(0,0,0,0.7); }
  .chart-pct { font-family: 'DM Mono', monospace; font-size: 0.82rem; min-width: 44px; text-align: right; }

  .weak-areas { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1rem; }
  .weak-card {
    background: var(--surface);
    border: 1px solid rgba(239,83,80,0.3);
    border-radius: var(--radius);
    padding: 1.25rem;
  }
  .weak-card .wname { font-weight: 600; margin-bottom: 0.25rem; }
  .weak-card .wstat { font-family: 'DM Mono', monospace; font-size: 0.82rem; color: var(--error); }
  .weak-card .wpct { font-size: 0.8rem; color: var(--text-muted); margin-top: 0.25rem; }

  .history-table { width: 100%; border-collapse: collapse; font-size: 0.88rem; }
  .history-table th { text-align: left; padding: 0.75rem 1rem; border-bottom: 1px solid var(--border); color: var(--text-muted); font-weight: 400; font-family: 'DM Mono', monospace; font-size: 0.78rem; text-transform: uppercase; letter-spacing: 0.5px; }
  .history-table td { padding: 0.75rem 1rem; border-bottom: 1px solid rgba(42,45,58,0.5); }
  .history-table tr:last-child td { border-bottom: none; }
  .badge { display: inline-block; padding: 0.2rem 0.6rem; border-radius: 4px; font-size: 0.75rem; font-family: 'DM Mono', monospace; }
  .badge.good { background: rgba(102,187,106,0.15); color: var(--success); }
  .badge.mid { background: rgba(255,167,38,0.15); color: var(--warn); }
  .badge.bad { background: rgba(239,83,80,0.15); color: var(--error); }

  /* === JSON IMPORT === */
  .import-area { display: flex; flex-direction: column; gap: 1.5rem; }
  .import-zone {
    border: 2px dashed var(--border);
    border-radius: var(--radius);
    padding: 3rem 2rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    background: var(--surface);
  }
  .import-zone:hover { border-color: var(--accent); background: rgba(232,197,71,0.03); }
  .import-zone-icon { font-size: 3rem; margin-bottom: 1rem; }
  .import-zone-text { color: var(--text-muted); font-size: 0.92rem; }
  .import-zone-text strong { color: var(--text); display: block; font-size: 1rem; margin-bottom: 0.5rem; }

  .code-area {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1.25rem;
  }
  .code-area h3 { font-size: 0.9rem; color: var(--text-muted); margin-bottom: 1rem; font-family: 'DM Mono', monospace; }
  textarea.json-input {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--accent2);
    font-family: 'DM Mono', monospace;
    font-size: 0.82rem;
    padding: 1rem;
    min-height: 260px;
    outline: none;
    resize: vertical;
    line-height: 1.6;
    transition: border-color 0.2s;
  }
  textarea.json-input:focus { border-color: var(--accent2); }
  .import-actions { display: flex; gap: 0.75rem; margin-top: 1rem; }
  .import-msg { padding: 0.75rem 1rem; border-radius: 8px; font-size: 0.88rem; display: none; margin-top: 0.75rem; }
  .import-msg.ok { background: rgba(102,187,106,0.1); border: 1px solid rgba(102,187,106,0.3); color: var(--success); display: block; }
  .import-msg.err { background: rgba(239,83,80,0.1); border: 1px solid rgba(239,83,80,0.3); color: var(--error); display: block; }

  /* === SESSION RESULTS === */
  .session-results {
    text-align: center;
    padding: 3rem 2rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
  }
  .session-score {
    font-family: 'Playfair Display', serif;
    font-size: 5rem; font-weight: 900;
    color: var(--accent);
    line-height: 1;
    margin: 1rem 0;
  }
  .session-score span { font-size: 2rem; color: var(--text-muted); }
  .session-breakdown { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin: 2rem 0; }
  .sb-item { text-align: center; }
  .sb-val { font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 700; }
  .sb-lbl { font-size: 0.78rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }

  /* === THEORY VIEW === */
  .theory-nav { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 2rem; }
  .th-nav-btn {
    background: var(--surface); border: 1px solid var(--border);
    color: var(--text-muted); padding: 0.5rem 1rem; border-radius: 20px;
    cursor: pointer; font-size: 0.82rem; font-family: 'DM Sans', sans-serif;
    transition: all 0.15s;
  }
  .th-nav-btn:hover, .th-nav-btn.active { background: var(--accent); color: #000; border-color: var(--accent); font-weight: 600; }

  .theory-section { display: none; }
  .theory-section.active { display: block; }

  .th-hero {
    background: linear-gradient(135deg, var(--surface2) 0%, var(--surface) 100%);
    border: 1px solid var(--border); border-radius: var(--radius);
    padding: 2rem; margin-bottom: 1.5rem;
  }
  .th-hero h2 { font-family: 'Playfair Display', serif; font-size: 1.8rem; margin-bottom: 0.5rem; }
  .th-hero p { color: var(--text-muted); line-height: 1.7; }

  .th-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
  .th-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 1.25rem;
    border-left: 3px solid var(--card-color, var(--accent));
  }
  .th-card h4 { font-size: 0.95rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--card-color, var(--accent)); }
  .th-card p, .th-card li { font-size: 0.88rem; line-height: 1.7; color: var(--text-muted); }
  .th-card ul { padding-left: 1.2rem; }
  .th-card li { margin-bottom: 0.3rem; }
  .th-card li strong { color: var(--text); }
  .th-card code {
    background: var(--surface2); padding: 0.1rem 0.4rem; border-radius: 4px;
    font-family: 'DM Mono', monospace; font-size: 0.82rem; color: var(--accent2);
  }

  .th-table-wrap { overflow-x: auto; margin-bottom: 1.5rem; }
  .th-table {
    width: 100%; border-collapse: collapse; font-size: 0.85rem;
    background: var(--surface); border-radius: var(--radius); overflow: hidden;
  }
  .th-table th {
    background: var(--surface2); padding: 0.75rem 1rem;
    text-align: left; font-family: 'DM Mono', monospace; font-size: 0.78rem;
    text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-muted);
    border-bottom: 1px solid var(--border);
  }
  .th-table td { padding: 0.75rem 1rem; border-bottom: 1px solid rgba(42,45,58,0.5); vertical-align: top; line-height: 1.6; }
  .th-table tr:last-child td { border-bottom: none; }
  .th-table tr:hover td { background: var(--surface2); }
  .th-table .hl { color: var(--accent); font-family: 'DM Mono', monospace; font-size: 0.82rem; }
  .th-table .hl2 { color: var(--accent2); font-family: 'DM Mono', monospace; font-size: 0.82rem; }
  .th-table .hl3 { color: var(--accent3); font-family: 'DM Mono', monospace; font-size: 0.82rem; }

  .hack-box {
    background: rgba(232,197,71,0.05); border: 1px solid rgba(232,197,71,0.3);
    border-radius: var(--radius); padding: 1.25rem 1.5rem; margin-bottom: 1rem;
  }
  .hack-box h4 { color: var(--accent); font-size: 0.9rem; margin-bottom: 0.6rem; display: flex; align-items: center; gap: 0.5rem; }
  .hack-box p, .hack-box li { font-size: 0.88rem; color: var(--text-muted); line-height: 1.7; }
  .hack-box ul { padding-left: 1.2rem; }
  .hack-box li { margin-bottom: 0.4rem; }
  .hack-box li strong { color: var(--text); }
  .hack-box code { background: var(--surface2); padding: 0.1rem 0.4rem; border-radius: 4px; font-family: 'DM Mono', monospace; font-size: 0.82rem; color: var(--accent2); }

  .warn-box {
    background: rgba(239,83,80,0.06); border: 1px solid rgba(239,83,80,0.25);
    border-radius: var(--radius); padding: 1.25rem 1.5rem; margin-bottom: 1rem;
  }
  .warn-box h4 { color: var(--error); font-size: 0.9rem; margin-bottom: 0.6rem; }
  .warn-box p, .warn-box li { font-size: 0.88rem; color: var(--text-muted); line-height: 1.7; }
  .warn-box ul { padding-left: 1.2rem; }
  .warn-box li { margin-bottom: 0.4rem; }
  .warn-box li strong { color: var(--text); }

  .info-box {
    background: rgba(79,195,247,0.05); border: 1px solid rgba(79,195,247,0.25);
    border-radius: var(--radius); padding: 1.25rem 1.5rem; margin-bottom: 1rem;
  }
  .info-box h4 { color: var(--accent2); font-size: 0.9rem; margin-bottom: 0.6rem; }
  .info-box p, .info-box li { font-size: 0.88rem; color: var(--text-muted); line-height: 1.7; }
  .info-box ul { padding-left: 1.2rem; }
  .info-box li { margin-bottom: 0.4rem; }
  .info-box li strong { color: var(--text); }
  .info-box code { background: var(--surface2); padding: 0.1rem 0.4rem; border-radius: 4px; font-family: 'DM Mono', monospace; font-size: 0.82rem; color: var(--accent); }

  .th-section-title {
    font-family: 'Playfair Display', serif; font-size: 1.3rem;
    margin: 1.75rem 0 1rem;
    padding-bottom: 0.5rem; border-bottom: 1px solid var(--border);
    color: var(--text);
  }
  .th-section-title:first-of-type { margin-top: 0; }

  .example-block {
    background: var(--surface2); border-radius: 8px;
    padding: 1rem 1.25rem; margin: 0.75rem 0;
    font-size: 0.88rem; line-height: 1.8;
    border-left: 2px solid var(--accent2);
  }
  .example-block .label { font-family: 'DM Mono', monospace; font-size: 0.72rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 0.3rem; }
  .example-block em { color: var(--accent); font-style: normal; font-family: 'DM Mono', monospace; }

  .keyword-grid { display: flex; flex-wrap: wrap; gap: 0.5rem; margin: 0.75rem 0 1.25rem; }
  .keyword-tag {
    background: var(--surface2); border: 1px solid var(--border);
    border-radius: 6px; padding: 0.3rem 0.75rem;
    font-family: 'DM Mono', monospace; font-size: 0.8rem;
    color: var(--accent2);
  }
  .keyword-tag span { color: var(--text-muted); font-size: 0.72rem; margin-left: 0.3rem; }

  @media (max-width: 600px) { .th-grid { grid-template-columns: 1fr; } }

  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

  @media (max-width: 600px) {
    .stats-row { grid-template-columns: repeat(2, 1fr); }
    .session-breakdown { grid-template-columns: repeat(3, 1fr); }
    .chart-label { min-width: 100px; font-size: 0.78rem; }
  }
</style>
</head>
<body>

<header>
  <div class="logo">
    MATURA <em style="color:var(--accent)">EN</em>
    <span>Trener Angielskiego Rozszerzonego</span>
  </div>
  <nav>
    <button class="nav-btn active" onclick="showView('home')">üè† Strona g≈Ç√≥wna</button>
    <button class="nav-btn" onclick="showView('stats')">üìä Postƒôpy</button>
    <button class="nav-btn" onclick="showView('theory')">üìí Teoria & Hacki</button>
    <button class="nav-btn" onclick="showView('import')">üìÇ Import JSON</button>
  </nav>
</header>

<main>
  <!-- HOME VIEW -->
  <div id="view-home" class="view active">
    <div class="hero">
      <h1>Zdaj maturƒô z <em>angielskiego</em><br>rozszerzonego</h1>
      <p>ƒÜwicz zadania z ostatnich lat. ≈öled≈∫ postƒôpy. Odkryj s≈Çabe strony.</p>
    </div>
    <div class="stats-row" id="global-stats">
      <div class="stat-card"><span class="val" id="stat-total">0</span><span class="lbl">Zada≈Ñ ≈ÇƒÖcznie</span></div>
      <div class="stat-card"><span class="val" id="stat-done">0</span><span class="lbl">Zrobionych</span></div>
      <div class="stat-card"><span class="val" id="stat-score">0%</span><span class="lbl">Skuteczno≈õƒá</span></div>
      <div class="stat-card"><span class="val" id="stat-streak">0</span><span class="lbl">Dni z rzƒôdu</span></div>
    </div>
    <div class="categories-grid" id="categories-grid"></div>

    <div class="theory-promo" onclick="showView('theory')" style="margin-top:1.5rem;cursor:pointer;background:linear-gradient(135deg,#1c1f2a 0%,#13151c 100%);border:1px solid #e8c547;border-radius:12px;padding:1.75rem 2rem;display:flex;align-items:center;gap:2rem;transition:transform 0.2s,box-shadow 0.2s;" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 8px 32px rgba(232,197,71,0.12)'" onmouseout="this.style.transform='';this.style.boxShadow=''">
      <div style="font-size:3rem;flex-shrink:0">üìí</div>
      <div>
        <div style="font-family:'Playfair Display',serif;font-size:1.3rem;color:var(--accent);margin-bottom:0.3rem">Teoria & Hacki maturalne</div>
        <div style="color:var(--text-muted);font-size:0.88rem;line-height:1.6">Czasy angielskie, strona bierna, mowa zale≈ºna, transformacje zda≈Ñ, word formation, wskaz√≥wki do zada≈Ñ pisemnych ‚Äî wszystko w jednym miejscu. Zanim zaczniesz ƒáwiczyƒá, naucz siƒô teorii.</div>
      </div>
      <div style="margin-left:auto;flex-shrink:0;color:var(--accent);font-size:1.5rem">‚Üí</div>
    </div>
  </div>

  <!-- EXERCISE VIEW -->
  <div id="view-exercise" class="view">
    <div class="ex-header">
      <button class="back-btn" onclick="endSession()">‚Üê Wr√≥ƒá</button>
      <span class="ex-category-badge" id="ex-cat-name">‚Äî</span>
      <div class="ex-progress-bar"><div class="ex-progress-fill" id="ex-progress-fill" style="width:0%"></div></div>
      <span class="ex-counter" id="ex-counter">0/0</span>
    </div>
    <div id="exercise-area"></div>
  </div>

  <!-- STATS VIEW -->
  <div id="view-stats" class="view">
    <div class="stats-section">
      <h2>Wyniki wed≈Çug kategorii</h2>
      <div class="chart-bars" id="chart-categories"></div>
    </div>
    <div class="stats-section">
      <h2>S≈Çabe punkty</h2>
      <div class="weak-areas" id="weak-areas"></div>
    </div>
    <div class="stats-section">
      <h2>Historia sesji</h2>
      <table class="history-table">
        <thead><tr><th>Data</th><th>Kategoria</th><th>Wynik</th><th>Czas</th><th>Ocena</th></tr></thead>
        <tbody id="history-tbody"></tbody>
      </table>
    </div>
  </div>

  <!-- IMPORT VIEW -->
  <div id="view-import" class="view">
    <div class="import-area">
      <div class="import-zone" onclick="document.getElementById('file-input').click()">
        <div class="import-zone-icon">üìÑ</div>
        <div class="import-zone-text">
          <strong>PrzeciƒÖgnij plik JSON lub kliknij</strong>
          Format: tablica zada≈Ñ zgodna ze schematem matura-exercises.json
        </div>
        <input type="file" id="file-input" accept=".json" style="display:none" onchange="handleFileImport(event)">
      </div>

      <div class="code-area">
        <h3>// lub wklej JSON bezpo≈õrednio</h3>
        <textarea class="json-input" id="json-textarea" placeholder='[
  {
    "id": "unique-id",
    "category": "reading",
    "type": "multiple_choice",
    "instruction": "Przeczytaj tekst i odpowiedz na pytania.",
    "text": "...",
    "question": "What is the main topic?",
    "options": ["A. ...", "B. ...", "C. ...", "D. ..."],
    "answer": "A",
    "explanation": "Wyja≈õnienie poprawnej odpowiedzi."
  }
]'></textarea>
        <div class="import-actions">
          <button class="btn btn-primary" onclick="importJSON()">Importuj zadania</button>
          <button class="btn btn-secondary" onclick="loadSampleData()">Za≈Çaduj przyk≈Çadowe zadania</button>
          <button class="btn btn-secondary" onclick="exportProgress()">Eksportuj postƒôpy</button>
        </div>
        <div class="import-msg" id="import-msg"></div>
      </div>

      <div class="code-area">
        <h3>// schemat JSON ‚Äî jak dodawaƒá w≈Çasne zadania</h3>
        <pre style="color:var(--text-muted);font-family:'DM Mono',monospace;font-size:0.78rem;line-height:1.8;white-space:pre-wrap">{
  <span style="color:var(--accent)">"id"</span>: "unikalne-id",
  <span style="color:var(--accent)">"category"</span>: "reading" | "grammar" | "vocabulary" | "writing" | "use_of_english" | "listening_text",
  <span style="color:var(--accent)">"type"</span>: "multiple_choice" | "fill_blank" | "true_false_ng" | "open_answer" | "word_formation" | "essay" | "email" | "sentence_transform",
  <span style="color:var(--accent)">"instruction"</span>: "Instrukcja dla ucznia",
  <span style="color:var(--accent)">"text"</span>: "Opcjonalny tekst do przeczytania",
  <span style="color:var(--accent)">"question"</span>: "Pytanie lub polecenie",
  <span style="color:var(--accent)">"options"</span>: ["A. ...", "B. ...", "C. ...", "D. ..."],  // dla MCQ
  <span style="color:var(--accent)">"blanks"</span>: [{"num":1,"hint":"czasownik","answer":"have been"}],  // dla fill_blank
  <span style="color:var(--accent)">"answer"</span>: "Poprawna odpowied≈∫",
  <span style="color:var(--accent)">"explanation"</span>: "Wyja≈õnienie",
  <span style="color:var(--accent)">"points"</span>: 1,
  <span style="color:var(--accent)">"year"</span>: 2023
}</pre>
      </div>
    </div>
  </div>
  <!-- THEORY VIEW -->
  <div id="view-theory" class="view">
    <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem">
      <button class="back-btn" onclick="showView('home')">‚Üê Wr√≥ƒá</button>
      <div>
        <div style="font-family:'Playfair Display',serif;font-size:1.6rem">üìí Teoria & Hacki Maturalne</div>
        <div style="color:var(--text-muted);font-size:0.85rem">Angielski Rozszerzony ‚Äî kompendium wiedzy</div>
      </div>
    </div>

    <!-- NAV TABS -->
    <div class="theory-nav">
      <button class="th-nav-btn active" onclick="showTheory('tenses')">‚è∞ Czasy</button>
      <button class="th-nav-btn" onclick="showTheory('passive')">üîÑ Strona bierna</button>
      <button class="th-nav-btn" onclick="showTheory('conditionals')">üîÄ Kondycjonalis</button>
      <button class="th-nav-btn" onclick="showTheory('reported')">üí¨ Mowa zale≈ºna</button>
      <button class="th-nav-btn" onclick="showTheory('modal')">üéØ Modals</button>
      <button class="th-nav-btn" onclick="showTheory('transforms')">üîë Transformacje</button>
      <button class="th-nav-btn" onclick="showTheory('wordform')">üß¨ Word Formation</button>
      <button class="th-nav-btn" onclick="showTheory('reading')">üìñ Reading</button>
      <button class="th-nav-btn" onclick="showTheory('writing')">‚úçÔ∏è Writing</button>
      <button class="th-nav-btn" onclick="showTheory('collocations')">üß© Kolokacje</button>
    </div>

    <!-- ======= CZASY ======= -->
    <div class="theory-section active" id="th-tenses">
      <div class="th-hero">
        <h2>‚è∞ Czasy angielskie</h2>
        <p>16 czas√≥w angielskich pogrupowanych wed≈Çug aspektu. Na maturze rozszerzonej najczƒô≈õciej testowane sƒÖ: Present Perfect (Simple/Continuous), Past Perfect, Future forms i czasy w zdaniach podrzƒôdnych.</p>
      </div>

      <div class="th-section-title">PrzeglƒÖd wszystkich czas√≥w</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Czas</th><th>Budowa</th><th>Kiedy u≈ºywaƒá</th><th>Przyk≈Çad</th></tr>
          <tr><td><strong>Present Simple</strong></td><td class="hl">V / V-s</td><td>fakty, nawyki, harmonogramy</td><td class="hl2">She works every day.</td></tr>
          <tr><td><strong>Present Continuous</strong></td><td class="hl">am/is/are + V-ing</td><td>teraz, plany na bliskƒÖ przysz≈Ço≈õƒá</td><td class="hl2">I am studying now.</td></tr>
          <tr><td><strong>Present Perfect Simple</strong></td><td class="hl">have/has + V3</td><td>do≈õwiadczenie, wynik, niedawna przesz≈Ço≈õƒá</td><td class="hl2">I have seen that film.</td></tr>
          <tr><td><strong>Present Perfect Continuous</strong></td><td class="hl">have/has been + V-ing</td><td>czynno≈õƒá trwajƒÖca do teraz (akcent na czas/efekt)</td><td class="hl2">I've been waiting for 2h.</td></tr>
          <tr><td><strong>Past Simple</strong></td><td class="hl">V2 / did + V</td><td>zako≈Ñczona czynno≈õƒá w przesz≈Ço≈õci</td><td class="hl2">She left yesterday.</td></tr>
          <tr><td><strong>Past Continuous</strong></td><td class="hl">was/were + V-ing</td><td>czynno≈õƒá trwajƒÖca w tle, przerywana</td><td class="hl2">I was reading when he called.</td></tr>
          <tr><td><strong>Past Perfect Simple</strong></td><td class="hl">had + V3</td><td>czynno≈õƒá wcze≈õniejsza od innej przesz≈Çej</td><td class="hl2">She had left before I arrived.</td></tr>
          <tr><td><strong>Past Perfect Continuous</strong></td><td class="hl">had been + V-ing</td><td>czynno≈õƒá trwajƒÖca do pewnego momentu w przesz≈Ço≈õci</td><td class="hl2">He had been waiting for hours.</td></tr>
          <tr><td><strong>Future Simple (will)</strong></td><td class="hl">will + V</td><td>decyzja spontaniczna, przewidywanie, obietnica</td><td class="hl2">I'll call you later.</td></tr>
          <tr><td><strong>be going to</strong></td><td class="hl">am/is/are going to + V</td><td>plan lub zamiar, oczywiste przewidywanie</td><td class="hl2">It's going to rain.</td></tr>
          <tr><td><strong>Future Continuous</strong></td><td class="hl">will be + V-ing</td><td>czynno≈õƒá trwajƒÖca w przysz≈Ço≈õci o okre≈õlonej godzinie</td><td class="hl2">At 8pm I'll be studying.</td></tr>
          <tr><td><strong>Future Perfect</strong></td><td class="hl">will have + V3</td><td>czynno≈õƒá sko≈Ñczona przed punktem w przysz≈Ço≈õci</td><td class="hl2">By June I will have finished.</td></tr>
        </table>
      </div>

      <div class="th-section-title">Kluczowe s≈Çowa-sygna≈Çy</div>
      <div class="th-grid">
        <div class="th-card" style="--card-color:#e8c547">
          <h4>Present Perfect ‚Äî sygna≈Çy</h4>
          <div class="keyword-grid">
            <span class="keyword-tag">already</span><span class="keyword-tag">yet</span><span class="keyword-tag">just</span><span class="keyword-tag">ever</span><span class="keyword-tag">never</span><span class="keyword-tag">since</span><span class="keyword-tag">for</span><span class="keyword-tag">recently</span><span class="keyword-tag">so far</span><span class="keyword-tag">lately</span><span class="keyword-tag">it's the first time</span>
          </div>
          <div class="example-block"><div class="label">Przyk≈Çady</div>
            I have <em>already</em> eaten.<br>
            She has lived here <em>since</em> 2010.<br>
            Have you <em>ever</em> been to Japan?
          </div>
        </div>
        <div class="th-card" style="--card-color:#4fc3f7">
          <h4>Past Simple ‚Äî sygna≈Çy</h4>
          <div class="keyword-grid">
            <span class="keyword-tag">yesterday</span><span class="keyword-tag">ago</span><span class="keyword-tag">last year</span><span class="keyword-tag">in 2010</span><span class="keyword-tag">when</span><span class="keyword-tag">then</span>
          </div>
          <div class="example-block"><div class="label">Przyk≈Çady</div>
            She left <em>yesterday</em>.<br>
            I met him <em>three years ago</em>.<br>
            <em>When</em> I was young, I played piano.
          </div>
        </div>
        <div class="th-card" style="--card-color:#f06292">
          <h4>Future Perfect ‚Äî sygna≈Çy</h4>
          <div class="keyword-grid">
            <span class="keyword-tag">by the time</span><span class="keyword-tag">by + data</span><span class="keyword-tag">before</span><span class="keyword-tag">in ... years</span>
          </div>
          <div class="example-block"><div class="label">Przyk≈Çady</div>
            <em>By the time</em> you arrive, I will have finished.<br>
            <em>By 2030</em>, they will have launched the rocket.
          </div>
        </div>
      </div>

      <div class="hack-box">
        <h4>üí° Hack #1 ‚Äî PPS vs. PS: jak wybraƒá?</h4>
        <ul>
          <li>Je≈õli zdanie ma <strong>dwie czynno≈õci w przesz≈Ço≈õci</strong> ‚Äî ta <em>wcze≈õniejsza</em> idzie w Past Perfect: <code>When she arrived, he had already left.</code></li>
          <li>S≈Çowa-klucze Past Perfect: <strong>already, by the time, after, before, when (poprzednika), as soon as</strong></li>
          <li>Je≈õli jest tylko <strong>jedna czynno≈õƒá</strong> ‚Äî Past Simple wystarczy.</li>
        </ul>
      </div>
      <div class="warn-box">
        <h4>‚ö†Ô∏è Najczƒôstsze b≈Çƒôdy na maturze</h4>
        <ul>
          <li><strong>‚ùå</strong> <code>I have seen him yesterday.</code> ‚Üí ‚ùå yesterday = Past Simple ‚Üí <strong>‚úÖ</strong> <code>I saw him yesterday.</code></li>
          <li><strong>‚ùå</strong> <code>She is knowing the answer.</code> ‚Üí czasowniki statyczne (know, like, believe) nie tworzƒÖ Continuous ‚Üí <strong>‚úÖ</strong> <code>She knows.</code></li>
          <li><strong>‚ùå</strong> <code>When I will arrive, call me.</code> ‚Üí po "when" (czas) u≈ºywamy Present Simple ‚Üí <strong>‚úÖ</strong> <code>When I arrive...</code></li>
        </ul>
      </div>
    </div>

    <!-- ======= STRONA BIERNA ======= -->
    <div class="theory-section" id="th-passive">
      <div class="th-hero">
        <h2>üîÑ Strona bierna (Passive Voice)</h2>
        <p>Na maturze rozszerzonej strona bierna pojawia siƒô w transformacjach zda≈Ñ, fill-in-the-blank oraz w esejach (szczeg√≥lnie akademickich). Musisz umieƒá tworzyƒá jƒÖ we wszystkich czasach i z modals.</p>
      </div>

      <div class="th-section-title">Budowa strony biernej we wszystkich czasach</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Czas</th><th>Budowa (passive)</th><th>Przyk≈Çad</th></tr>
          <tr><td>Present Simple</td><td class="hl">am/is/are + V3</td><td class="hl2">The letter is written every day.</td></tr>
          <tr><td>Present Continuous</td><td class="hl">am/is/are being + V3</td><td class="hl2">The bridge is being built.</td></tr>
          <tr><td>Present Perfect</td><td class="hl">have/has been + V3</td><td class="hl2">It has been decided.</td></tr>
          <tr><td>Past Simple</td><td class="hl">was/were + V3</td><td class="hl2">The law was passed in 2010.</td></tr>
          <tr><td>Past Continuous</td><td class="hl">was/were being + V3</td><td class="hl2">The road was being repaired.</td></tr>
          <tr><td>Past Perfect</td><td class="hl">had been + V3</td><td class="hl2">The report had been submitted.</td></tr>
          <tr><td>Future Simple</td><td class="hl">will be + V3</td><td class="hl2">The results will be announced.</td></tr>
          <tr><td>Modal verbs</td><td class="hl">modal + be + V3</td><td class="hl2">It should be done. / It must be stopped.</td></tr>
          <tr><td>Modal + Perfect</td><td class="hl">modal + have been + V3</td><td class="hl2">It could have been avoided.</td></tr>
        </table>
      </div>

      <div class="th-section-title">Reporting verbs w stronie biernej (matura!)</div>
      <div class="info-box">
        <h4>üìå Wzory ‚Äî kluczowe na transformacjach zda≈Ñ</h4>
        <ul>
          <li><code>People say that he is rich.</code> ‚Üí <strong>He is said to be rich.</strong></li>
          <li><code>People believe that she won.</code> ‚Üí <strong>She is believed to have won.</strong></li>
          <li><code>They expect the team to win.</code> ‚Üí <strong>The team is expected to win.</strong></li>
          <li><code>Experts claim he discovered it.</code> ‚Üí <strong>He is claimed to have discovered it.</strong></li>
        </ul>
        <p style="margin-top:0.75rem"><strong>Schemat:</strong> Subject + <code>is/are + [said/believed/reported/claimed/thought/known/expected/supposed] + to (have) + V</code></p>
        <p>Przesz≈Ço≈õƒá (that clause w przesz≈Ço≈õci) ‚Üí <code>to have + V3</code><br>Tera≈∫niejszo≈õƒá ‚Üí <code>to + V</code></p>
      </div>

      <div class="hack-box">
        <h4>üí° Hack #2 ‚Äî Passive z "get"</h4>
        <ul>
          <li><code>Get + V3</code> to nieformalny odpowiednik: <strong>She got fired. / He got injured.</strong></li>
          <li>U≈ºywaj w e-mailach nieformalnych, unikaj w esejach akademickich.</li>
          <li>Typowe kolokacje: <code>get paid / get promoted / get arrested / get married / get lost</code></li>
        </ul>
      </div>
      <div class="warn-box">
        <h4>‚ö†Ô∏è Pu≈Çapki ‚Äî Phrasal verbs w stronie biernej</h4>
        <ul>
          <li>Zachowaj przyimek! <strong>‚ùå</strong> <code>The office was broken.</code> ‚Üí <strong>‚úÖ</strong> <code>The office was broken into.</code></li>
          <li><code>look after ‚Üí The children were looked after.</code></li>
          <li><code>deal with ‚Üí The problem was dealt with.</code></li>
          <li><code>call off ‚Üí The match was called off.</code></li>
        </ul>
      </div>
    </div>

    <!-- ======= KONDYCJONALIS ======= -->
    <div class="theory-section" id="th-conditionals">
      <div class="th-hero">
        <h2>üîÄ Zdania warunkowe (Conditionals)</h2>
        <p>Jeden z najwa≈ºniejszych dzia≈Ç√≥w na maturze rozszerzonej. Musisz znaƒá wszystkie 4 typy + mixed conditionals + inwersjƒô + wyra≈ºenia alternatywne.</p>
      </div>

      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Typ</th><th>If-clause</th><th>Main clause</th><th>Znaczenie</th><th>Przyk≈Çad</th></tr>
          <tr><td><strong>Zero</strong></td><td class="hl">Present Simple</td><td class="hl">Present Simple</td><td>fakty, prawa natury</td><td class="hl2">If you heat water to 100¬∞C, it boils.</td></tr>
          <tr><td><strong>1st</strong></td><td class="hl">Present Simple</td><td class="hl">will + V</td><td>realny, mo≈ºliwy warunek</td><td class="hl2">If it rains, I will stay home.</td></tr>
          <tr><td><strong>2nd</strong></td><td class="hl">Past Simple</td><td class="hl">would + V</td><td>hipotetyczny (tera≈∫niejszo≈õƒá)</td><td class="hl2">If I were rich, I would travel.</td></tr>
          <tr><td><strong>3rd</strong></td><td class="hl">Past Perfect</td><td class="hl">would have + V3</td><td>nierealne (przesz≈Ço≈õƒá)</td><td class="hl2">If I had studied, I would have passed.</td></tr>
          <tr><td><strong>Mixed</strong></td><td class="hl">Past Perfect</td><td class="hl">would + V</td><td>przesz≈Ço≈õƒá ‚Üí skutek teraz</td><td class="hl2">If I had studied, I would be a doctor now.</td></tr>
        </table>
      </div>

      <div class="th-section-title">Inwersja warunkowa (bez "if") ‚Äî ulubiony temat egzaminator√≥w!</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Normalnie</th><th>Inwersja</th></tr>
          <tr><td class="hl2">If I had known...</td><td class="hl"><strong>Had I known...</strong></td></tr>
          <tr><td class="hl2">If it were not for her...</td><td class="hl"><strong>Were it not for her...</strong></td></tr>
          <tr><td class="hl2">If you should need help...</td><td class="hl"><strong>Should you need help...</strong></td></tr>
          <tr><td class="hl2">If it were not for the rain...</td><td class="hl"><strong>But for the rain...</strong></td></tr>
        </table>
      </div>

      <div class="th-section-title">Alternatywne wyra≈ºenia warunkowe</div>
      <div class="th-grid">
        <div class="th-card" style="--card-color:#e8c547">
          <h4>Zamiast "if"</h4>
          <ul>
            <li><strong>Unless</strong> = if...not: <code>Unless you hurry, you'll miss it.</code></li>
            <li><strong>Provided/providing (that)</strong> = pod warunkiem ≈ºe</li>
            <li><strong>As long as</strong> = dop√≥ki</li>
            <li><strong>On condition (that)</strong> = pod warunkiem</li>
            <li><strong>Supposing/Imagine (that)</strong> = wyobra≈∫ sobie ≈ºe</li>
            <li><strong>In case</strong> = na wypadek gdyby (‚â† if!)</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#f06292">
          <h4>Wyra≈ºenia ze znaczeniem "gdyby nie"</h4>
          <ul>
            <li><strong>But for + noun:</strong> <code>But for her help, I would have failed.</code></li>
            <li><strong>Were it not for:</strong> <code>Were it not for the traffic...</code></li>
            <li><strong>Had it not been for:</strong> <code>Had it not been for the rain...</code></li>
            <li><strong>Without:</strong> <code>Without your support, I couldn't have done it.</code></li>
          </ul>
        </div>
      </div>

      <div class="hack-box">
        <h4>üí° Hack #3 ‚Äî Wish / If only / It's time</h4>
        <ul>
          <li><code>I wish + Past Simple</code> = ≈ºyczenie o tera≈∫niejszo≈õci: <strong>I wish I knew the answer.</strong></li>
          <li><code>I wish + Past Perfect</code> = ≈ºal za przesz≈Ço≈õciƒÖ: <strong>I wish I had studied harder.</strong></li>
          <li><code>I wish + would</code> = irytacja (dot. innych): <strong>I wish he would stop talking.</strong></li>
          <li><code>If only</code> = intensywniejsza wersja wish: <strong>If only I had been there!</strong></li>
          <li><code>It's (high) time + Past Simple</code>: <strong>It's high time you started studying.</strong></li>
          <li><code>I'd rather/sooner + Past Simple</code> (o innych): <strong>I'd rather you didn't tell anyone.</strong></li>
        </ul>
      </div>
    </div>

    <!-- ======= MOWA ZALE≈ªNA ======= -->
    <div class="theory-section" id="th-reported">
      <div class="th-hero">
        <h2>üí¨ Mowa zale≈ºna (Reported Speech)</h2>
        <p>Transformacje z mowy niezale≈ºnej na zale≈ºnƒÖ i odwrotnie to sta≈Çy element matury. Kluczowe: cofanie czas√≥w (backshift), zmiana zaimk√≥w i wyra≈ºe≈Ñ czasowych.</p>
      </div>

      <div class="th-section-title">Cofanie czas√≥w (Backshift)</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Mowa niezale≈ºna</th><th>Mowa zale≈ºna</th></tr>
          <tr><td class="hl">Present Simple ‚Üí </td><td class="hl2">Past Simple: "I work" ‚Üí he said he <em>worked</em></td></tr>
          <tr><td class="hl">Present Continuous ‚Üí </td><td class="hl2">Past Continuous: "I'm working" ‚Üí he said he <em>was working</em></td></tr>
          <tr><td class="hl">Present Perfect ‚Üí </td><td class="hl2">Past Perfect: "I have done" ‚Üí she said she <em>had done</em></td></tr>
          <tr><td class="hl">Past Simple ‚Üí </td><td class="hl2">Past Perfect: "I went" ‚Üí he said he <em>had gone</em></td></tr>
          <tr><td class="hl">will ‚Üí </td><td class="hl2">would: "I will go" ‚Üí she said she <em>would go</em></td></tr>
          <tr><td class="hl">can ‚Üí </td><td class="hl2">could: "I can help" ‚Üí he said he <em>could help</em></td></tr>
          <tr><td class="hl">may ‚Üí </td><td class="hl2">might: "It may rain" ‚Üí she said it <em>might rain</em></td></tr>
          <tr><td class="hl">must (obowiƒÖzek) ‚Üí </td><td class="hl2">had to: "I must leave" ‚Üí he said he <em>had to leave</em></td></tr>
        </table>
      </div>

      <div class="th-section-title">Zmiana wyra≈ºe≈Ñ czasowych i miejsca</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Mowa niezale≈ºna</th><th>Mowa zale≈ºna</th></tr>
          <tr><td class="hl2">now</td><td class="hl">then / at that time</td></tr>
          <tr><td class="hl2">today</td><td class="hl">that day</td></tr>
          <tr><td class="hl2">yesterday</td><td class="hl">the day before / the previous day</td></tr>
          <tr><td class="hl2">tomorrow</td><td class="hl">the next day / the following day</td></tr>
          <tr><td class="hl2">last week</td><td class="hl">the week before / the previous week</td></tr>
          <tr><td class="hl2">here</td><td class="hl">there</td></tr>
          <tr><td class="hl2">this / these</td><td class="hl">that / those</td></tr>
          <tr><td class="hl2">ago</td><td class="hl">before / earlier</td></tr>
        </table>
      </div>

      <div class="th-section-title">Reporting verbs z wzorami</div>
      <div class="th-grid">
        <div class="th-card" style="--card-color:#e8c547">
          <h4>Verb + to-infinitive</h4>
          <ul>
            <li><strong>agree, offer, refuse, promise, decide, threaten</strong></li>
            <li>"I'll help." ‚Üí <code>He offered to help.</code></li>
            <li>"I won't do it." ‚Üí <code>She refused to do it.</code></li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#4fc3f7">
          <h4>Verb + sb + to-infinitive</h4>
          <ul>
            <li><strong>ask, tell, warn, order, advise, remind, encourage, beg</strong></li>
            <li>"Don't touch it!" ‚Üí <code>She warned us not to touch it.</code></li>
            <li>"Please come." ‚Üí <code>He asked her to come.</code></li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#f06292">
          <h4>Verb + that-clause</h4>
          <ul>
            <li><strong>say, tell, claim, admit, explain, insist, deny, suggest</strong></li>
            <li>"I didn't do it." ‚Üí <code>He denied doing it.</code></li>
            <li>"suggest" + gerund lub that + should: <code>She suggested going / that we go.</code></li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#a5d6a7">
          <h4>Verb + -ing</h4>
          <ul>
            <li><strong>admit, deny, suggest, recommend, confess, apologise for</strong></li>
            <li>"I'm sorry I was late." ‚Üí <code>She apologised for being late.</code></li>
            <li>"I broke it." ‚Üí <code>He admitted breaking it.</code></li>
          </ul>
        </div>
      </div>
      <div class="warn-box">
        <h4>‚ö†Ô∏è Nie cofaj, gdy wprowadzasz zdanie og√≥lnie prawdziwe</h4>
        <ul>
          <li>"Paris is the capital of France." ‚Üí <code>He said Paris is the capital of France.</code> (prawda og√≥lna ‚Äî brak cofniƒôcia)</li>
        </ul>
      </div>
    </div>

    <!-- ======= MODALS ======= -->
    <div class="theory-section" id="th-modal">
      <div class="th-hero">
        <h2>üéØ Czasowniki modalne (Modal Verbs)</h2>
        <p>Modals wyra≈ºajƒÖ mo≈ºliwo≈õƒá, konieczno≈õƒá, prawdopodobie≈Ñstwo i pozwolenie. Na maturze szczeg√≥lnie wa≈ºne sƒÖ modals w odniesieniu do przesz≈Ço≈õci (modal + have + V3).</p>
      </div>

      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Modal</th><th>Znaczenie</th><th>Przesz≈Ço≈õƒá (+ have + V3)</th><th>Przyk≈Çad</th></tr>
          <tr><td class="hl">must</td><td>obowiƒÖzek / pewna dedukcja (+)</td><td class="hl3">must have done = z pewno≈õciƒÖ zrobi≈Ç</td><td class="hl2">He must have left early.</td></tr>
          <tr><td class="hl">can't / couldn't</td><td>niemo≈ºliwo≈õƒá</td><td class="hl3">can't have done = niemo≈ºliwe ≈ºe zrobi≈Ç</td><td class="hl2">She can't have been there.</td></tr>
          <tr><td class="hl">might / may / could</td><td>mo≈ºliwo≈õƒá</td><td class="hl3">might have done = byƒá mo≈ºe zrobi≈Ç</td><td class="hl2">He might have forgotten.</td></tr>
          <tr><td class="hl">should</td><td>rada / oczekiwanie</td><td class="hl3">should have done = powinienem by≈Ç (ale nie)</td><td class="hl2">You should have called me.</td></tr>
          <tr><td class="hl">shouldn't</td><td>zakaz / krytyka</td><td class="hl3">shouldn't have done = nie powinienem by≈Ç</td><td class="hl2">He shouldn't have lied.</td></tr>
          <tr><td class="hl">needn't</td><td>brak konieczno≈õci</td><td class="hl3">needn't have done = nie musia≈Ç (ale zrobi≈Ç)</td><td class="hl2">You needn't have bought it.</td></tr>
          <tr><td class="hl">didn't need to</td><td>brak konieczno≈õci</td><td>nie musia≈Ç (i nie zrobi≈Ç)</td><td class="hl2">He didn't need to come.</td></tr>
          <tr><td class="hl">would</td><td>przesz≈Çe nawyki</td><td>‚Äî</td><td class="hl2">We would go there every summer.</td></tr>
          <tr><td class="hl">used to</td><td>przesz≈Çe nawyki/stany</td><td>‚Äî</td><td class="hl2">I used to play piano as a child.</td></tr>
        </table>
      </div>

      <div class="hack-box">
        <h4>üí° Hack #4 ‚Äî Dedukcja o przesz≈Ço≈õci (must/can't/might have)</h4>
        <ul>
          <li>Pewno≈õƒá (+): <strong>must have</strong> ‚Üí <code>She must have taken the wrong bus. (jestem pewien)</code></li>
          <li>Niemo≈ºliwo≈õƒá: <strong>can't have</strong> ‚Üí <code>He can't have done it ‚Äî he was with me. (niemo≈ºliwe)</code></li>
          <li>Mo≈ºliwo≈õƒá: <strong>might/may/could have</strong> ‚Üí <code>They might have missed the train. (mo≈ºe)</code></li>
          <li>≈ªal: <strong>should/ought to have</strong> ‚Üí <code>I should have apologised. (powinienem by≈Ç)</code></li>
        </ul>
      </div>
    </div>

    <!-- ======= TRANSFORMACJE ======= -->
    <div class="theory-section" id="th-transforms">
      <div class="th-hero">
        <h2>üîë Transformacje zda≈Ñ ‚Äî Key Word Transformations</h2>
        <p>Najtrudniejszy element Use of English. Egzaminator daje s≈Çowo kluczowe i 2‚Äì5 wyraz√≥w do wpisania. Poni≈ºej najczƒô≈õciej testowane wzory.</p>
      </div>

      <div class="th-section-title">TOP wzory ‚Äî musisz znaƒá na pamiƒôƒá</div>
      <div class="th-grid">
        <div class="th-card" style="--card-color:#e8c547">
          <h4>so...that ‚Üí too...to / enough</h4>
          <ul>
            <li><code>so tired that she couldn't walk</code> ‚Üí <strong>too tired to walk</strong></li>
            <li><code>so strong that he can lift it</code> ‚Üí <strong>strong enough to lift it</strong></li>
            <li><code>not enough + noun</code> ‚Üí <strong>too few / too little</strong></li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#4fc3f7">
          <h4>Active ‚Üí Passive</h4>
          <ul>
            <li><code>They built it in 1990.</code> ‚Üí <strong>It was built in 1990.</strong></li>
            <li><code>People say he is rich.</code> ‚Üí <strong>He is said to be rich.</strong></li>
            <li><code>They have just announced...</code> ‚Üí <strong>... has just been announced.</strong></li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#f06292">
          <h4>Conditional transforms</h4>
          <ul>
            <li><code>If she hadn't helped...</code> ‚Üí <strong>Had she not helped... / But for her help...</strong></li>
            <li><code>unless = if...not</code></li>
            <li><code>as long as / provided that</code> = je≈õli tylko</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#a5d6a7">
          <h4>Verb patterns</h4>
          <ul>
            <li><code>remember/forget + to-inf</code> vs <code>+ -ing</code> (r√≥≈ºne znaczenia!)</li>
            <li><code>stop + -ing</code> = przestaƒá; <code>stop + to-inf</code> = zatrzymaƒá siƒô ≈ºeby</li>
            <li><code>try + -ing</code> = spr√≥bowaƒá; <code>try + to-inf</code> = usi≈Çowaƒá</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#ffb74d">
          <h4>Reporting verbs</h4>
          <ul>
            <li><code>warned us not to</code> / <code>advised us to</code></li>
            <li><code>denied doing</code> / <code>admitted doing</code></li>
            <li><code>suggested that we go</code> / <code>suggested going</code></li>
            <li><code>apologised for + -ing</code></li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#ce93d8">
          <h4>Prepositional phrases</h4>
          <ul>
            <li><code>in spite of / despite + noun/-ing</code></li>
            <li><code>due to / because of + noun</code></li>
            <li><code>on the grounds that</code> = z powodu tego ≈ºe</li>
            <li><code>with a view to + -ing</code> = w celu</li>
          </ul>
        </div>
      </div>

      <div class="hack-box">
        <h4>üí° Hack #5 ‚Äî Strategia rozwiƒÖzywania transformacji</h4>
        <ul>
          <li><strong>Krok 1:</strong> Znajd≈∫ kategoriƒô ‚Äî patrz na S≈ÅOWO KLUCZOWE. <code>WISH</code> ‚Üí ≈ºal. <code>BEEN</code> ‚Üí passive. <code>UNLESS</code> ‚Üí conditional.</li>
          <li><strong>Krok 2:</strong> Policz wyrazy w luce ‚Äî muszƒÖ byƒá 2‚Äì5 (w≈ÇƒÖcznie ze s≈Çowem kluczowym).</li>
          <li><strong>Krok 3:</strong> Nie zmieniaj formy s≈Çowa kluczowego! <code>WISH</code> musi zostaƒá <code>wish</code>.</li>
          <li><strong>Krok 4:</strong> Sprawd≈∫, czy sens zdania jest zachowany ‚Äî nie zmieniaj czasu akcji.</li>
          <li><strong>Krok 5:</strong> Uwa≈ºaj na skr√≥ty ‚Äî <code>haven't</code> = 2 wyrazy, <code>have not</code> = te≈º 2.</li>
        </ul>
      </div>
    </div>

    <!-- ======= WORD FORMATION ======= -->
    <div class="theory-section" id="th-wordform">
      <div class="th-hero">
        <h2>üß¨ Word Formation ‚Äî Tworzenie wyraz√≥w</h2>
        <p>Sta≈Çy element matury rozszerzonej. Musisz rozpoznaƒá, jakiej formy (noun/adjective/adverb/verb) wymaga luka i zastosowaƒá w≈Ça≈õciwy przedrostek lub przyrostek.</p>
      </div>

      <div class="th-section-title">Kluczowe przedrostki (Prefixes)</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Prefiks</th><th>Znaczenie</th><th>Przyk≈Çady</th></tr>
          <tr><td class="hl">un-</td><td>nie-, od-</td><td class="hl2">unhappy, unlikely, unfair, undo, unable, unaware</td></tr>
          <tr><td class="hl">in-/im-/il-/ir-</td><td>nie-</td><td class="hl2">incorrect, impossible, illegal, irregular, invisible</td></tr>
          <tr><td class="hl">dis-</td><td>nie-, roz-</td><td class="hl2">disagree, dishonest, disappear, discomfort</td></tr>
          <tr><td class="hl">mis-</td><td>≈∫le, b≈Çƒôdnie</td><td class="hl2">misunderstand, mislead, misuse, misjudge</td></tr>
          <tr><td class="hl">over-</td><td>prze-, zbyt</td><td class="hl2">overestimate, overworked, overreact, overcome</td></tr>
          <tr><td class="hl">under-</td><td>za ma≈Ço, pod-</td><td class="hl2">underestimate, underpaid, undermine</td></tr>
          <tr><td class="hl">pre-</td><td>przed-</td><td class="hl2">prehistoric, predict, prevent, precaution</td></tr>
          <tr><td class="hl">re-</td><td>ponownie</td><td class="hl2">rewrite, rethink, rebuild, reconsider</td></tr>
          <tr><td class="hl">inter-</td><td>miƒôdzy-</td><td class="hl2">international, interact, interconnected</td></tr>
        </table>
      </div>

      <div class="th-section-title">Przyrostki rzeczownikowe (Noun Suffixes)</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Przyrostek</th><th>Typ</th><th>Przyk≈Çady</th></tr>
          <tr><td class="hl">-tion / -sion / -ation</td><td>czynno≈õƒá/stan</td><td class="hl2">education, pollution, decision, imagination</td></tr>
          <tr><td class="hl">-ness</td><td>stan/cecha</td><td class="hl2">happiness, sadness, awareness, darkness</td></tr>
          <tr><td class="hl">-ity / -ty</td><td>cecha</td><td class="hl2">ability, creativity, equality, safety</td></tr>
          <tr><td class="hl">-ment</td><td>wynik/czynno≈õƒá</td><td class="hl2">employment, achievement, improvement</td></tr>
          <tr><td class="hl">-ance / -ence</td><td>stan/cecha</td><td class="hl2">importance, independence, reliance</td></tr>
          <tr><td class="hl">-er / -or / -ist / -ian</td><td>osoba</td><td class="hl2">teacher, director, scientist, musician</td></tr>
          <tr><td class="hl">-ship</td><td>relacja/stan</td><td class="hl2">friendship, leadership, scholarship</td></tr>
          <tr><td class="hl">-hood</td><td>stan/okres</td><td class="hl2">childhood, neighbourhood, likelihood</td></tr>
        </table>
      </div>

      <div class="th-section-title">Przyrostki przymiotnikowe i przys≈Ç√≥wkowe</div>
      <div class="th-grid">
        <div class="th-card" style="--card-color:#4fc3f7">
          <h4>Adjective suffixes</h4>
          <ul>
            <li><strong>-ful:</strong> helpful, careful, powerful</li>
            <li><strong>-less:</strong> careless, useless, helpless</li>
            <li><strong>-ous / -ious:</strong> dangerous, ambitious, conscious</li>
            <li><strong>-able / -ible:</strong> acceptable, responsible, flexible</li>
            <li><strong>-al / -ical:</strong> environmental, historical</li>
            <li><strong>-ic:</strong> scientific, catastrophic, economic</li>
            <li><strong>-ive:</strong> creative, effective, decisive</li>
            <li><strong>-ing / -ed:</strong> boring/bored, surprising/surprised</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#f06292">
          <h4>Verb suffixes</h4>
          <ul>
            <li><strong>-ise / -ize:</strong> realise, recognise, minimise</li>
            <li><strong>-en:</strong> widen, shorten, strengthen, weaken</li>
            <li><strong>-ify:</strong> simplify, clarify, intensify, justify</li>
          </ul>
          <h4 style="margin-top:0.75rem">Adverb suffixes</h4>
          <ul>
            <li><strong>-ly:</strong> quickly, carefully, honestly</li>
            <li>Uwaga: <strong>friendly, lovely, likely</strong> ‚Üí przymiotniki!</li>
          </ul>
        </div>
      </div>

      <div class="hack-box">
        <h4>üí° Hack #6 ‚Äî Strategia word formation</h4>
        <ul>
          <li><strong>Krok 1:</strong> Sprawd≈∫ rolƒô w zdaniu ‚Äî jaka czƒô≈õƒá mowy jest potrzebna? (rzeczownik? przymiotnik?)</li>
          <li><strong>Krok 2:</strong> Sprawd≈∫, czy potrzebny jest <strong>prefiks negacji</strong> (kontekst jest negatywny?).</li>
          <li><strong>Krok 3:</strong> Sprawd≈∫ liczbƒô i formƒô ‚Äî czy rzeczownik ma byƒá w liczbie mnogiej?</li>
          <li><strong>Krok 4:</strong> Uwa≈ºaj na <strong>nieregularne zmiany:</strong> <code>strong ‚Üí strength</code>, <code>wide ‚Üí width</code>, <code>long ‚Üí length</code>, <code>decide ‚Üí decision</code>, <code>describe ‚Üí description</code></li>
          <li><strong>Nieregularne ‚Äûpu≈Çapki":</strong> <code>able ‚Üí ability</code>, <code>curious ‚Üí curiosity</code>, <code>probable ‚Üí probability</code></li>
        </ul>
      </div>
    </div>

    <!-- ======= READING ======= -->
    <div class="theory-section" id="th-reading">
      <div class="th-hero">
        <h2>üìñ Strategie ‚Äî Rozumienie Tekst√≥w</h2>
        <p>Na maturze rozszerzonej sƒÖ 3 typy zada≈Ñ do tekst√≥w: wielokrotny wyb√≥r, dobieranie (nag≈Ç√≥wki/zdania), prawda/fa≈Çsz/brak informacji. Ka≈ºdy wymaga innej strategii.</p>
      </div>

      <div class="th-grid">
        <div class="th-card" style="--card-color:#e8c547">
          <h4>üìå Multiple Choice ‚Äî krok po kroku</h4>
          <ul>
            <li><strong>1.</strong> Przeczytaj pytanie ZANIM przeczytasz tekst.</li>
            <li><strong>2.</strong> Zaznacz s≈Çowa kluczowe w pytaniu.</li>
            <li><strong>3.</strong> Znajd≈∫ odpowiedni akapit w tek≈õcie.</li>
            <li><strong>4.</strong> Szukaj <em>parafraz</em> ‚Äî odpowied≈∫ nigdy nie jest s≈Çowo w s≈Çowo z tekstu.</li>
            <li><strong>5.</strong> Eliminuj b≈Çƒôdne: uwa≈ºaj na opcje <em>prawdziwe ale niezwiƒÖzane</em> z pytaniem.</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#4fc3f7">
          <h4>üìå True / False / Not Given</h4>
          <ul>
            <li><strong>TRUE:</strong> informacja WPROST potwierdzona w tek≈õcie (jako parafraza).</li>
            <li><strong>FALSE:</strong> tekst m√≥wi CO≈ö PRZECIWNEGO do zdania.</li>
            <li><strong>NOT GIVEN:</strong> tekst NIE wspomina o tej kwestii ‚Äî nawet je≈õli logicznie siƒô to wydaje mo≈ºliwe.</li>
            <li>‚ö†Ô∏è Nie u≈ºywaj wiedzy og√≥lnej ‚Äî tylko to, co jest w tek≈õcie!</li>
            <li>S≈Çowa ekstremlane (always, never, all, only) czƒôsto = FALSE.</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#f06292">
          <h4>üìå Uwaga na pu≈Çapki MCQ</h4>
          <ul>
            <li><strong>Partial truth:</strong> opcja jest czƒô≈õciowo prawdziwa ale niekompletna.</li>
            <li><strong>Too extreme:</strong> "always", "never", "completely" ‚Äî rzadko poprawne.</li>
            <li><strong>Opposite meaning:</strong> sprawd≈∫ negacje i przeczenia.</li>
            <li><strong>Wrong referent:</strong> dotyczy innej osoby/rzeczy ni≈º pytanie.</li>
          </ul>
        </div>
      </div>
      <div class="info-box">
        <h4>üìñ S≈Çownictwo do rozumienia intencji autora</h4>
        <p>Egzaminator mo≈ºe pytaƒá o stosunek/nastawienie autora. Kluczowe s≈Çowa w tek≈õcie:</p>
        <div class="keyword-grid" style="margin-top:0.75rem">
          <span class="keyword-tag">however<span>= kontrast</span></span>
          <span class="keyword-tag">nevertheless<span>= jednak</span></span>
          <span class="keyword-tag">yet<span>= mimo to</span></span>
          <span class="keyword-tag">arguably<span>= mo≈ºna twierdziƒá</span></span>
          <span class="keyword-tag">crucially<span>= co istotne</span></span>
          <span class="keyword-tag">paradoxically<span>= paradoksalnie</span></span>
          <span class="keyword-tag">while/whereas<span>= podczas gdy</span></span>
          <span class="keyword-tag">despite<span>= pomimo</span></span>
        </div>
      </div>
    </div>

    <!-- ======= WRITING ======= -->
    <div class="theory-section" id="th-writing">
      <div class="th-hero">
        <h2>‚úçÔ∏è Wypowied≈∫ Pisemna ‚Äî Esej & E-mail</h2>
        <p>Za wypowied≈∫ pisemnƒÖ mo≈ºna dostaƒá do 13 punkt√≥w. Liczy siƒô: tre≈õƒá (4), sp√≥jno≈õƒá i logika (2), zakres s≈Çownictwa (3), poprawno≈õƒá jƒôzykowa (3) oraz d≈Çugo≈õƒá i forma (1).</p>
      </div>

      <div class="th-section-title">Esej argumentacyjny ‚Äî struktura</div>
      <div class="th-card" style="--card-color:#e8c547;margin-bottom:1rem">
        <h4>Szablon eseju (200‚Äì250 s≈Ç√≥w)</h4>
        <ul>
          <li><strong>¬ß1 Wstƒôp (2‚Äì3 zd.):</strong> Wprowad≈∫ temat + przedstaw tezƒô. Nie kopiuj polecenia ‚Äî przeformu≈Çuj.</li>
          <li><strong>¬ß2 Argument ZA (3‚Äì4 zd.):</strong> G≈Ç√≥wny argument + rozwiniƒôcie + przyk≈Çad.</li>
          <li><strong>¬ß3 Argument PRZECIW + kontrargument (4‚Äì5 zd.):</strong> Uznaj racjƒô drugiej strony ale odpierz jƒÖ.</li>
          <li><strong>¬ß4 Zako≈Ñczenie (2‚Äì3 zd.):</strong> Podsumuj + jasno wyra≈∫ w≈ÇasnƒÖ opiniƒô.</li>
        </ul>
      </div>

      <div class="th-section-title">≈ÅƒÖczniki sp√≥jno≈õci ‚Äî musisz ich u≈ºywaƒá!</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Funkcja</th><th>≈ÅƒÖczniki</th></tr>
          <tr><td>Dodawanie</td><td class="hl2">Furthermore, Moreover, In addition, What is more, Not only... but also</td></tr>
          <tr><td>Kontrast</td><td class="hl2">However, Nevertheless, On the other hand, In contrast, Conversely, That said</td></tr>
          <tr><td>Przyczyna</td><td class="hl2">Therefore, As a result, Consequently, Hence, This leads to</td></tr>
          <tr><td>Przyk≈Çad</td><td class="hl2">For instance, For example, To illustrate, Such as, A case in point is</td></tr>
          <tr><td>Uznanie arg. opp.</td><td class="hl2">Admittedly, It is true that, While it may be argued that, Although</td></tr>
          <tr><td>Konkluzja</td><td class="hl2">In conclusion, To sum up, On balance, All things considered, It is clear that</td></tr>
        </table>
      </div>

      <div class="th-section-title">E-mail formalny vs. nieformalny</div>
      <div class="th-grid">
        <div class="th-card" style="--card-color:#4fc3f7">
          <h4>üìß E-mail FORMALNY</h4>
          <ul>
            <li><strong>Otwarcie:</strong> Dear Mr/Ms [Surname], / Dear Sir or Madam,</li>
            <li><strong>Cel:</strong> I am writing to enquire about... / I am writing with regard to...</li>
            <li><strong>Styl:</strong> pe≈Çne formy (I am, I have), brak slang√≥w, formalne s≈Çownictwo</li>
            <li><strong>Zamkniƒôcie:</strong> I look forward to hearing from you. / Yours sincerely, (znasz imiƒô) / Yours faithfully, (nie znasz)</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#f06292">
          <h4>üì± E-mail NIEFORMALNY</h4>
          <ul>
            <li><strong>Otwarcie:</strong> Hi/Hey [Name]! / Great to hear from you!</li>
            <li><strong>Styl:</strong> skr√≥ty (I'm, can't, won't), potoczne wyra≈ºenia, emotki ew.</li>
            <li><strong>Tre≈õƒá:</strong> osobisty, ≈ºywy, bezpo≈õredni ton</li>
            <li><strong>Zamkniƒôcie:</strong> Take care! / Looking forward to seeing you! / [Imiƒô]</li>
          </ul>
        </div>
      </div>

      <div class="hack-box">
        <h4>üí° Hack #7 ‚Äî Jak zdobyƒá punkty za zakres s≈Çownictwa</h4>
        <ul>
          <li>Unikaj prostych s≈Ç√≥w: <code>good ‚Üí excellent/outstanding/remarkable</code>, <code>bad ‚Üí detrimental/problematic/concerning</code>, <code>say ‚Üí claim/argue/contend/assert</code></li>
          <li>U≈ºywaj kolokacji: <code>raise awareness, tackle an issue, have far-reaching consequences, draw a conclusion</code></li>
          <li>U≈ºyj pasywnej strony: <code>It has been argued that... / It is widely believed that...</code></li>
          <li>R√≥≈ºnicuj struktury: zdania proste + z≈Ço≈ºone + z inwersjƒÖ</li>
        </ul>
      </div>
      <div class="warn-box">
        <h4>‚ö†Ô∏è Czego unikaƒá w eseju</h4>
        <ul>
          <li>Nie pisz w 1. osobie liczby mnogiej (We all know...) ‚Äî zbyt potoczne</li>
          <li>Nie zaczynaj zda≈Ñ od: <em>Because, Also, And, But</em></li>
          <li>Nie u≈ºywaj jƒôzyka potocznego: <em>kids, stuff, a lot of, gonna</em></li>
          <li>Nie przekraczaj limitu s≈Ç√≥w o wiƒôcej ni≈º 10% ‚Äî egzaminator mo≈ºe nie czytaƒá reszty</li>
        </ul>
      </div>
    </div>

    <!-- ======= KOLOKACJE ======= -->
    <div class="theory-section" id="th-collocations">
      <div class="th-hero">
        <h2>üß© Kolokacje & Wyra≈ºenia Idiomatyczne</h2>
        <p>Znajomo≈õƒá kolokacji to r√≥≈ºnica miƒôdzy poziomem B2 a C1. Poni≈ºej kolokacje wed≈Çug temat√≥w najczƒô≈õciej pojawiajƒÖcych siƒô na maturze rozszerzonej.</p>
      </div>

      <div class="th-section-title">Kolokacje tematyczne</div>
      <div class="th-grid">
        <div class="th-card" style="--card-color:#e8c547">
          <h4>üåç ≈örodowisko</h4>
          <ul>
            <li>tackle / address climate change</li>
            <li>reduce carbon emissions / footprint</li>
            <li>raise environmental awareness</li>
            <li>preserve biodiversity</li>
            <li>renewable energy sources</li>
            <li>have far-reaching consequences</li>
            <li>pose a threat to ecosystems</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#4fc3f7">
          <h4>üíº Praca i gospodarka</h4>
          <ul>
            <li>seek employment / pursue a career</li>
            <li>work-life balance</li>
            <li>boost economic growth</li>
            <li>face redundancy / be made redundant</li>
            <li>bridge the skills gap</li>
            <li>launch a startup / run a business</li>
            <li>meet a deadline</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#f06292">
          <h4>üì± Technologia i media</h4>
          <ul>
            <li>have a significant impact on</li>
            <li>spread misinformation / fake news</li>
            <li>invade privacy</li>
            <li>become heavily reliant on</li>
            <li>artificial intelligence poses risks</li>
            <li>social media platforms</li>
            <li>digital literacy</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#a5d6a7">
          <h4>üè• Zdrowie i spo≈Çecze≈Ñstwo</h4>
          <ul>
            <li>lead a healthy lifestyle</li>
            <li>tackle obesity / mental health issues</li>
            <li>cope with stress / pressure</li>
            <li>seek professional help</li>
            <li>have access to healthcare</li>
            <li>exacerbate inequalities</li>
            <li>marginalised communities</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#ffb74d">
          <h4>üéì Edukacja</h4>
          <ul>
            <li>acquire knowledge / skills</li>
            <li>broaden one's horizons</li>
            <li>foster critical thinking</li>
            <li>provide equal opportunities</li>
            <li>fall behind / catch up</li>
            <li>extracurricular activities</li>
            <li>lifelong learning</li>
          </ul>
        </div>
        <div class="th-card" style="--card-color:#ce93d8">
          <h4>üî¨ Nauka i badania</h4>
          <ul>
            <li>conduct / carry out research</li>
            <li>groundbreaking discovery</li>
            <li>draw conclusions from data</li>
            <li>raise ethical concerns</li>
            <li>peer-reviewed studies</li>
            <li>yield results / findings</li>
            <li>challenge established beliefs</li>
          </ul>
        </div>
      </div>

      <div class="th-section-title">Phrasal verbs ‚Äî TOP 30 na maturƒô</div>
      <div class="th-table-wrap">
        <table class="th-table">
          <tr><th>Phrasal verb</th><th>Znaczenie</th><th>Przyk≈Çad</th></tr>
          <tr><td class="hl">bring about</td><td>spowodowaƒá</td><td class="hl2">The new policy brought about significant changes.</td></tr>
          <tr><td class="hl">call off</td><td>odwo≈Çaƒá</td><td class="hl2">The event was called off due to bad weather.</td></tr>
          <tr><td class="hl">carry out</td><td>przeprowadziƒá</td><td class="hl2">Scientists carried out experiments.</td></tr>
          <tr><td class="hl">come across</td><td>natknƒÖƒá siƒô</td><td class="hl2">She came across an interesting article.</td></tr>
          <tr><td class="hl">deal with</td><td>zajmowaƒá siƒô</td><td class="hl2">We need to deal with this problem.</td></tr>
          <tr><td class="hl">draw up</td><td>sporzƒÖdziƒá (plan)</td><td class="hl2">They drew up a new contract.</td></tr>
          <tr><td class="hl">give up</td><td>zrezygnowaƒá</td><td class="hl2">He gave up smoking last year.</td></tr>
          <tr><td class="hl">look into</td><td>zbadaƒá</td><td class="hl2">The police looked into the matter.</td></tr>
          <tr><td class="hl">make up for</td><td>nadrobiƒá, zrekompensowaƒá</td><td class="hl2">She worked extra hours to make up for lost time.</td></tr>
          <tr><td class="hl">phase out</td><td>wycofywaƒá stopniowo</td><td class="hl2">Coal plants will be phased out by 2030.</td></tr>
          <tr><td class="hl">put forward</td><td>zaproponowaƒá</td><td class="hl2">She put forward an interesting proposal.</td></tr>
          <tr><td class="hl">rule out</td><td>wykluczyƒá</td><td class="hl2">Doctors ruled out a serious illness.</td></tr>
          <tr><td class="hl">set out</td><td>wyruszyƒá; przedstawiƒá</td><td class="hl2">The report sets out the key findings.</td></tr>
          <tr><td class="hl">take over</td><td>przejƒÖƒá</td><td class="hl2">A larger company took over the startup.</td></tr>
          <tr><td class="hl">turn out</td><td>okazaƒá siƒô</td><td class="hl2">It turned out to be a mistake.</td></tr>
        </table>
      </div>
    </div>
  </div>

</main>

<script>
// ==================== STATE ====================
const STORAGE_KEY = 'matura_en_progress';
const EXERCISES_KEY = 'matura_en_exercises';

let state = {
  progress: {},     // id -> {attempts, correct, lastSeen}
  history: [],      // [{date, category, score, total, time}]
  streak: { lastDate: null, count: 0 },
  exercises: []
};

let session = {
  exercises: [],
  current: 0,
  correct: 0,
  wrong: 0,
  startTime: null,
  category: null,
  answered: false
};

// ==================== PERSISTENCE ====================
function saveState() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify({ progress: state.progress, history: state.history, streak: state.streak }));
  localStorage.setItem(EXERCISES_KEY, JSON.stringify(state.exercises));
}

function loadState() {
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) Object.assign(state, JSON.parse(saved));
  const exs = localStorage.getItem(EXERCISES_KEY);
  if (exs) state.exercises = JSON.parse(exs);
  else { loadBuiltinExercises(); saveState(); }
}

// ==================== CATEGORIES ====================
const CATEGORIES = {
  reading: { name: 'Rozumienie Tekst√≥w', icon: 'üìñ', desc: 'MCQ, prawda/fa≈Çsz/brak, pytania otwarte do tekst√≥w', color: '#4fc3f7' },
  grammar: { name: 'Gramatyka', icon: 'üîß', desc: 'Uzupe≈Çnianie luk, transformacje zda≈Ñ, czas i tryb', color: '#f06292' },
  vocabulary: { name: 'S≈Çownictwo', icon: 'üìö', desc: 'Tworzenie wyraz√≥w, dob√≥r leksyki, kolokacje', color: '#a5d6a7' },
  use_of_english: { name: 'Use of English', icon: '‚öôÔ∏è', desc: 'Luki, parafrazy, word formation, key word transformations', color: '#ffb74d' },
  writing: { name: 'Wypowied≈∫ Pisemna', icon: '‚úçÔ∏è', desc: 'Esej, e-mail, artyku≈Ç, recenzja ‚Äî ocena AI', color: '#ce93d8' },
  listening_text: { name: 'Tekst S≈Çuchany', icon: 'üéß', desc: 'Pytania do transkrypt√≥w z egzamin√≥w', color: '#80cbc4' },
};

// ==================== SAMPLE EXERCISES ====================
function loadBuiltinExercises() {
  state.exercises = [
    // === READING ===
    {id:"r1",category:"reading",type:"multiple_choice",year:2023,
      instruction:"Przeczytaj tekst i zaznacz w≈Ça≈õciwƒÖ odpowied≈∫ A, B, C lub D.",
      text:`The concept of "rewilding" has gained significant traction in recent years as a conservation strategy aimed at restoring ecosystems to their natural state. Unlike traditional conservation, which often focuses on protecting individual species, rewilding takes a broader approach by reintroducing apex predators and allowing nature to manage itself. In Europe, the reintroduction of wolves to Yellowstone in the 1990s is frequently cited as a landmark example of how predators can trigger a "trophic cascade" ‚Äî a chain reaction that ultimately benefits the entire ecosystem, including river dynamics.`,
      question:"What distinguishes rewilding from traditional conservation approaches?",
      options:["A. It focuses exclusively on protecting endangered plant species.","B. It takes a broader ecosystem view by reintroducing predators.","C. It relies primarily on human management of wildlife populations.","D. It is only applied in North American national parks."],
      answer:"B",explanation:"Tekst m√≥wi, ≈ºe rewilding 'takes a broader approach by reintroducing apex predators', w przeciwie≈Ñstwie do tradycyjnej ochrony skupionej na gatunkach."},

    {id:"r2",category:"reading",type:"true_false_ng",year:2023,
      instruction:"Przeczytaj zdania i zdecyduj: TRUE (T), FALSE (F), lub NOT GIVEN (NG).",
      text:`Remote work has fundamentally altered urban planning considerations. City planners are now grappling with the phenomenon of \"donut cities\" ‚Äî urban centres that are losing population to suburban and rural areas as workers no longer need to commute daily. Some economists predict this could lead to a permanent restructuring of real estate markets, with commercial property in city centres losing value while demand for larger homes in less densely populated areas grows. However, critics argue that once pandemic restrictions fully lifted, many workers returned to offices, suggesting the shift may be less permanent than initially feared.`,
      question:"City planners unanimously agree that remote work will permanently change urban areas.",
      options:["A. TRUE","B. FALSE","C. NOT GIVEN"],
      answer:"B",explanation:"Tekst m√≥wi, ≈ºe 'critics argue' i≈º shift mo≈ºe nie byƒá permanentny ‚Äî co przeczy 'unanimously agree'. Odpowied≈∫ to FALSE."},

    {id:"r3",category:"reading",type:"multiple_choice",year:2022,
      instruction:"Przeczytaj tekst i zaznacz w≈Ça≈õciwƒÖ odpowied≈∫.",
      text:`Microplastics have now been detected in virtually every environment on Earth, from the deepest ocean trenches to the peaks of remote mountain ranges. What began as research into marine pollution has expanded into a global public health concern as these tiny particles, smaller than 5mm, have been found in human blood, lungs, and even placentas. Scientists are still debating the precise health implications, but initial studies suggest potential links to inflammation and hormonal disruption. The ubiquity of microplastics presents a unique challenge: unlike many pollutants, there is no clear source to shut down or regulate.`,
      question:"According to the text, what makes microplastic pollution particularly difficult to address?",
      options:["A. Scientists have not yet detected microplastics in the human body.","B. Microplastics are too small to be studied effectively in laboratories.","C. There is no single identifiable source that can be regulated.","D. The pollution is currently limited to ocean environments."],
      answer:"C",explanation:"Tekst stwierdza: 'there is no clear source to shut down or regulate' ‚Äî to czyni problem wyjƒÖtkowo trudnym."},

    // === GRAMMAR ===
    {id:"g1",category:"grammar",type:"sentence_transform",year:2023,
      instruction:"Uzupe≈Çnij drugie zdanie tak, aby mia≈Ço podobne znaczenie do pierwszego. U≈ºyj s≈Çowa kluczowego (2‚Äì5 wyraz√≥w).",
      question:"I regret not studying harder for the exam. (WISH)\nI _______ harder for the exam.",
      answer:"wish I had studied",explanation:"Wyra≈ºenie 'wish + past perfect' opisuje ≈ºal za przesz≈Ço≈õciƒÖ. I wish I had studied harder for the exam."},

    {id:"g2",category:"grammar",type:"fill_blank",year:2022,
      instruction:"Uzupe≈Çnij luki odpowiednimi formami s≈Ç√≥w.",
      text:"By the time we arrived at the station, the train ___1___ (already / leave). We had no choice but to wait for the next one, which ___2___ (not announce) yet.",
      blanks:[
        {num:1,hint:"past perfect",answer:"had already left"},
        {num:2,hint:"past perfect passive",answer:"had not been announced"}
      ],explanation:"Zdanie 1: past perfect (had already left) ‚Äî czynno≈õƒá wcze≈õniejsza. Zdanie 2: past perfect passive (had not been announced)."},

    {id:"g3",category:"grammar",type:"sentence_transform",year:2023,
      instruction:"Uzupe≈Çnij drugie zdanie s≈Çowem kluczowym (2‚Äì5 wyraz√≥w, nie zmieniaj formy s≈Çowa).",
      question:"It was such a boring lecture that most students fell asleep. (SO)\nThe lecture _______ most students fell asleep.",
      answer:"was so boring that",explanation:"Transformacja 'such + noun' ‚Üí 'so + adjective': 'was so boring that'."},

    {id:"g4",category:"grammar",type:"fill_blank",year:2024,
      instruction:"Wpisz poprawne s≈Çowo lub wyra≈ºenie w ka≈ºdƒÖ lukƒô.",
      text:"If I ___1___ (know) about the traffic, I would have taken a different route. Had I ___2___ (leave) earlier, I ___3___ (not be) late for the interview.",
      blanks:[
        {num:1,hint:"conditional past",answer:"had known"},
        {num:2,hint:"inversion conditional",answer:"left"},
        {num:3,hint:"would have",answer:"would not have been"}
      ],explanation:"Trzecia kondycjonalis: had known; inwersja Had I left; would not have been."},

    // === VOCABULARY / USE OF ENGLISH ===
    {id:"v1",category:"vocabulary",type:"fill_blank",year:2023,
      instruction:"Utw√≥rz wyraz od s≈Çowa w nawiasie, aby pasowa≈Ç do kontekstu zdania.",
      text:"The scientist's ___1___ (discover) of the new compound was met with ___2___ (skeptic) by the academic community. Nevertheless, her findings proved ___3___ (ground) for future research.",
      blanks:[
        {num:1,hint:"rzeczownik od discover",answer:"discovery"},
        {num:2,hint:"rzeczownik od skeptic",answer:"skepticism"},
        {num:3,hint:"przymiotnik od ground",answer:"groundbreaking"}
      ],explanation:"Tworzenie wyraz√≥w: discovery (noun), skepticism (noun), groundbreaking (adjective)."},

    {id:"v2",category:"use_of_english",type:"fill_blank",year:2022,
      instruction:"Wpisz jedno s≈Çowo, kt√≥re pasuje do wszystkich trzech zda≈Ñ (key word).",
      text:"1. She couldn't _____ up with the fast pace of the new job.\n2. Scientists need to _____ up with the latest research in their field.\n3. He ran so fast that nobody could _____ up with him.",
      blanks:[{num:1,hint:"jedno s≈Çowo do wszystkich 3 zda≈Ñ",answer:"keep"}],
      explanation:"'Keep up with' = nadƒÖ≈ºaƒá za. Jedno s≈Çowo pasujƒÖce do wszystkich trzech zda≈Ñ to KEEP."},

    {id:"v3",category:"vocabulary",type:"multiple_choice",year:2023,
      instruction:"Wybierz s≈Çowo, kt√≥re najlepiej pasuje do kontekstu.",
      question:"The new policy was met with considerable _______ from the opposition party, who argued it would harm the economy.",
      options:["A. acclaim","B. resistance","C. indifference","D. enthusiasm"],
      answer:"B",explanation:"'Resistance' (op√≥r, sprzeciw) najlepiej pasuje ‚Äî opozycja nie zgadza siƒô z politykƒÖ."},

    {id:"v4",category:"use_of_english",type:"sentence_transform",year:2024,
      instruction:"Przeformu≈Çuj zdanie, u≈ºywajƒÖc podanego s≈Çowa kluczowego (2‚Äì5 wyraz√≥w).",
      question:"Despite working overtime, she didn't finish the project. (MANAGE)\nShe _______ the project despite working overtime.",
      answer:"didn't manage to finish",explanation:"'Manage to do' = udaƒá siƒô co≈õ zrobiƒá. Negacja: didn't manage to finish."},

    // === WRITING ===
    {id:"w1",category:"writing",type:"essay",year:2023,
      instruction:"Napisz esej (ok. 200‚Äì250 s≈Ç√≥w) na podany temat. U≈ºyj odpowiedniej struktury: wstƒôp, rozwiniƒôcie (2 argumenty + kontrargument), zako≈Ñczenie.",
      question:"'Social media does more harm than good to young people's mental health.' Discuss both sides of this argument and give your own opinion.",
      answer:"",explanation:"Oce≈Ñ: 1) Struktura (wstƒôp, teza, argumenty za, przeciw, konkluzja) 2) Sp√≥jno≈õƒá i kohezja 3) Zakres s≈Çownictwa 4) Poprawno≈õƒá gramatyczna 5) Odpowiednia d≈Çugo≈õƒá"},

    {id:"w2",category:"writing",type:"email",year:2022,
      instruction:"Napisz e-mail formalny (ok. 150‚Äì200 s≈Ç√≥w) zgodnie z instrukcjƒÖ.",
      question:"You saw an advertisement for a summer internship at a technology company. Write an email to the HR department expressing your interest, outlining your relevant skills and experience, and asking about the application process.",
      answer:"",explanation:"Oce≈Ñ: 1) Odpowiedni rejestr (formalny) 2) W≈Ça≈õciwe zwroty otwierajƒÖce i zamykajƒÖce 3) Tre≈õƒá merytoryczna 4) Poprawno≈õƒá jƒôzykowa"},

    {id:"w3",category:"writing",type:"essay",year:2024,
      instruction:"Napisz rozprawkƒô (200‚Äì250 s≈Ç√≥w).",
      question:"'Space exploration is a waste of resources that should be invested in solving problems on Earth.' Do you agree or disagree? Discuss.",
      answer:"",explanation:"Kryteria CKE: tre≈õƒá (4 pkt), sp√≥jno≈õƒá i logika (2 pkt), zakres ≈õrodk√≥w jƒôzykowych (3 pkt), poprawno≈õƒá (3 pkt)."},

    // === LISTENING (as text) ===
    {id:"l1",category:"listening_text",type:"multiple_choice",year:2023,
      instruction:"Przeczytaj transkrypt nagrania i odpowiedz na pytania. (W oryginale to zadanie do s≈Çuchania.)",
      text:`INTERVIEWER: Dr. Patel, you've been researching urban heat islands for over a decade. Can you explain what exactly makes cities so much hotter than surrounding areas?
DR. PATEL: Certainly. The phenomenon has several causes. First, dark surfaces like asphalt and rooftops absorb significantly more solar radiation than vegetation. Second, buildings trap heat between them ‚Äî a canyon effect. Third, there's the direct heat output from vehicles, air conditioning, and industry. What people don't often realise is that the absence of trees is perhaps the most important factor, since vegetation cools its surroundings through transpiration.
INTERVIEWER: Are some cities tackling this effectively?
DR. PATEL: Singapore is frequently cited as a success story. They've integrated greenery into building design at every level ‚Äî literally growing gardens on facades and rooftops. Their approach has reduced local temperatures by measurable amounts. Rotterdam in the Netherlands is another example, focusing on water management and green roofs.`,
      question:"According to Dr. Patel, which factor does she consider MOST important in causing urban heat islands?",
      options:["A. The direct heat output from vehicles and industry.","B. The canyon effect created by tall buildings.","C. The lack of vegetation and its cooling effect.","D. The dark colour of road surfaces."],
      answer:"C",explanation:"Dr. Patel m√≥wi: 'the absence of trees is perhaps the most important factor, since vegetation cools its surroundings through transpiration.'"},

    {id:"l2",category:"listening_text",type:"true_false_ng",year:2022,
      instruction:"Na podstawie transkryptu zdecyduj: TRUE / FALSE / NOT GIVEN.",
      text:`PRESENTER: Welcome to Science Today. Today we're discussing a new study from the University of Edinburgh which examined the relationship between multilingualism and cognitive reserve. The researchers followed 853 participants over 25 years. Their key finding was that people who regularly switch between languages showed significantly slower rates of cognitive decline after the age of 65, compared to monolingual peers. Interestingly, the type of language ‚Äî whether related or unrelated to the native tongue ‚Äî seemed to make little difference. The effect was also observed regardless of socioeconomic status.`,
      question:"The study found that learning related languages (like Spanish and Italian) provides fewer cognitive benefits than learning unrelated languages.",
      options:["A. TRUE","B. FALSE","C. NOT GIVEN"],
      answer:"B",explanation:"Transkrypt wyra≈∫nie m√≥wi: 'the type of language seemed to make little difference' ‚Äî a wiƒôc twierdzenie jest FA≈ÅSZYWE."},

  ];
}

// ==================== VIEWS ====================
function showView(name) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('view-' + name).classList.add('active');
  // highlight correct nav button
  document.querySelectorAll('.nav-btn').forEach(b => {
    if (b.getAttribute('onclick') === `showView('${name}')`) b.classList.add('active');
  });
  if (name === 'home') renderHome();
  if (name === 'stats') renderStats();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// ==================== HOME ====================
function renderHome() {
  const exs = state.exercises;
  const total = exs.length;
  const done = Object.keys(state.progress).length;
  const allAttempts = Object.values(state.progress);
  const totalCorrect = allAttempts.reduce((a,p) => a + p.correct, 0);
  const totalAttempts = allAttempts.reduce((a,p) => a + p.attempts, 0);
  const score = totalAttempts > 0 ? Math.round(totalCorrect / totalAttempts * 100) : 0;

  document.getElementById('stat-total').textContent = total;
  document.getElementById('stat-done').textContent = done;
  document.getElementById('stat-score').textContent = score + '%';
  document.getElementById('stat-streak').textContent = state.streak.count || 0;

  const grid = document.getElementById('categories-grid');
  grid.innerHTML = '';

  Object.entries(CATEGORIES).forEach(([key, cat]) => {
    const catExs = exs.filter(e => e.category === key);
    const catDone = catExs.filter(e => state.progress[e.id]).length;
    const catAttempts = catExs.reduce((a,e) => a + (state.progress[e.id]?.attempts || 0), 0);
    const catCorrect = catExs.reduce((a,e) => a + (state.progress[e.id]?.correct || 0), 0);
    const catScore = catAttempts > 0 ? Math.round(catCorrect / catAttempts * 100) : 0;
    const pct = catExs.length > 0 ? Math.round(catDone / catExs.length * 100) : 0;

    const card = document.createElement('div');
    card.className = 'cat-card';
    card.style.setProperty('--cat-color', cat.color);
    card.innerHTML = `
      <div class="cat-icon">${cat.icon}</div>
      <div class="cat-name">${cat.name}</div>
      <div class="cat-desc">${cat.desc}</div>
      <div class="cat-progress"><div class="cat-progress-fill" style="width:${pct}%;background:${cat.color}"></div></div>
      <div class="cat-stats">
        <span>${catExs.length} zada≈Ñ</span>
        <span>${catDone} zrobionych</span>
        <span>${catScore}% trafnych</span>
      </div>`;
    card.onclick = () => startSession(key);
    grid.appendChild(card);
  });
}

// ==================== SESSION ====================
function startSession(category) {
  const all = state.exercises.filter(e => e.category === category);
  if (all.length === 0) { alert('Brak zada≈Ñ w tej kategorii. Dodaj zadania przez Import JSON.'); return; }

  // Sort: unseen first, then by lowest correct rate
  all.sort((a,b) => {
    const pa = state.progress[a.id];
    const pb = state.progress[b.id];
    if (!pa && !pb) return 0;
    if (!pa) return -1;
    if (!pb) return 1;
    const ra = pa.attempts > 0 ? pa.correct / pa.attempts : 0;
    const rb = pb.attempts > 0 ? pb.correct / pb.attempts : 0;
    return ra - rb;
  });

  session.exercises = all;
  session.current = 0;
  session.correct = 0;
  session.wrong = 0;
  session.startTime = Date.now();
  session.category = category;
  session.answered = false;

  showView('exercise');
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('ex-cat-name').textContent = CATEGORIES[category]?.name || category;
  renderExercise();
}

function renderExercise() {
  const ex = session.exercises[session.current];
  if (!ex) { showSessionResults(); return; }

  session.answered = false;
  const total = session.exercises.length;
  const idx = session.current + 1;
  document.getElementById('ex-counter').textContent = `${idx}/${total}`;
  document.getElementById('ex-progress-fill').style.width = ((idx - 1) / total * 100) + '%';

  const area = document.getElementById('exercise-area');
  const TYPE_LABELS = {
    multiple_choice: 'Wielokrotny wyb√≥r', fill_blank: 'Uzupe≈Çnij luki',
    true_false_ng: 'Prawda / Fa≈Çsz / Brak', sentence_transform: 'Transformacja zda≈Ñ',
    word_formation: 'Tworzenie wyraz√≥w', essay: 'Wypowied≈∫ pisemna',
    email: 'E-mail formalny / nieformalny', open_answer: 'Odpowied≈∫ otwarta'
  };

  let inputHTML = '';
  if (ex.type === 'multiple_choice' || ex.type === 'true_false_ng') {
    const opts = ex.options || [];
    inputHTML = `<div class="options">` + opts.map((o,i) => {
      const letter = String.fromCharCode(65 + i);
      return `<button class="option-btn" onclick="checkOption(this,'${letter}','${ex.answer}')" data-letter="${letter}">
        <span class="opt-letter">${letter}</span>${o.replace(/^[A-D]\.\s*/,'')}
      </button>`;
    }).join('') + `</div>`;
  } else if (ex.type === 'fill_blank') {
    if (ex.blanks && ex.blanks.length > 0) {
      inputHTML = `<div class="fill-blanks">` + ex.blanks.map(b =>
        `<div class="blank-row">
          <span class="blank-num">${b.num}.</span>
          <input class="blank-input" type="text" id="blank-${b.num}" placeholder="${b.hint || 'odpowied≈∫'}" autocomplete="off">
          <span class="blank-hint" id="blank-hint-${b.num}"></span>
        </div>`
      ).join('') + `</div>`;
    } else {
      inputHTML = `<input class="ex-input" type="text" id="single-input" placeholder="Wpisz odpowied≈∫..." autocomplete="off">`;
    }
  } else if (ex.type === 'sentence_transform' || ex.type === 'open_answer') {
    inputHTML = `<input class="ex-input" type="text" id="single-input" placeholder="Wpisz odpowied≈∫ (2‚Äì5 wyraz√≥w)..." autocomplete="off">`;
  } else if (ex.type === 'essay' || ex.type === 'email') {
    inputHTML = `<textarea class="ex-input" id="essay-input" placeholder="Napisz swojƒÖ wypowied≈∫ tutaj..."></textarea>`;
  }

  area.innerHTML = `<div class="exercise-card">
    <span class="ex-type-badge">${TYPE_LABELS[ex.type] || ex.type}${ex.year ? ' ¬∑ ' + ex.year : ''}</span>
    ${ex.instruction ? `<div class="ex-instruction">${ex.instruction}</div>` : ''}
    ${ex.text ? `<div class="ex-text">${ex.text.replace(/\n/g,'<br>')}</div>` : ''}
    <div class="ex-question">${ex.question || ''}</div>
    ${inputHTML}
    <div class="feedback-box" id="feedback-box"></div>
    <div class="action-row">
      ${ex.type === 'essay' || ex.type === 'email'
        ? `<button class="btn btn-secondary" id="self-pass-btn" onclick="selfGrade(true)">‚úÖ Poprawne</button>
           <button class="btn btn-secondary" onclick="selfGrade(false)" style="border-color:var(--error);color:var(--error)">‚ùå Do poprawy</button>`
        : `<button class="btn btn-primary" id="check-btn" onclick="checkAnswer()">Sprawd≈∫</button>`
      }
      <button class="btn btn-secondary" id="next-btn" onclick="nextExercise()" style="display:none">Nastƒôpne ‚Üí</button>
    </div>
  </div>`;
}

function checkOption(btn, letter, correct) {
  if (session.answered) return;
  session.answered = true;
  const ex = session.exercises[session.current];
  const isCorrect = letter === correct;
  document.querySelectorAll('.option-btn').forEach(b => {
    b.disabled = true;
    if (b.dataset.letter === correct) b.classList.add('correct');
    if (b === btn && !isCorrect) b.classList.add('wrong');
  });
  showFeedback(isCorrect, ex.explanation, correct);
  recordResult(ex.id, isCorrect);
  document.getElementById('next-btn').style.display = 'inline-flex';
}

function checkAnswer() {
  if (session.answered) return;
  const ex = session.exercises[session.current];
  let isCorrect = false;

  if (ex.type === 'fill_blank' && ex.blanks) {
    let allOk = true;
    ex.blanks.forEach(b => {
      const inp = document.getElementById('blank-' + b.num);
      if (!inp) return;
      const val = inp.value.trim().toLowerCase();
      const ok = val === b.answer.toLowerCase() || isCloseEnough(val, b.answer.toLowerCase());
      inp.classList.add(ok ? 'correct' : 'wrong');
      const hint = document.getElementById('blank-hint-' + b.num);
      if (hint) hint.textContent = ok ? '‚úì' : '‚úó ' + b.answer;
      if (!ok) allOk = false;
    });
    isCorrect = allOk;
  } else {
    const inp = document.getElementById('single-input');
    if (inp) {
      const val = inp.value.trim().toLowerCase();
      isCorrect = isCloseEnough(val, ex.answer.toLowerCase());
      inp.classList.add(isCorrect ? 'correct' : 'wrong');
      inp.disabled = true;
    }
  }

  session.answered = true;
  showFeedback(isCorrect, ex.explanation, ex.answer);
  recordResult(ex.id, isCorrect);
  document.getElementById('check-btn').style.display = 'none';
  document.getElementById('next-btn').style.display = 'inline-flex';
}

function selfGrade(passed) {
  session.answered = true;
  const ex = session.exercises[session.current];
  showFeedback(passed, ex.explanation || 'Kryteria: struktura, sp√≥jno≈õƒá, zakres s≈Çownictwa, poprawno≈õƒá.', null);
  recordResult(ex.id, passed);
  document.getElementById('next-btn').style.display = 'inline-flex';
  if (document.getElementById('self-pass-btn')) document.getElementById('self-pass-btn').style.display = 'none';
}

function isCloseEnough(val, correct) {
  if (val === correct) return true;
  // allow minor typos via Levenshtein for short answers
  if (correct.length > 20) {
    return val.includes(correct.split(' ').slice(0,3).join(' ')) || correct.includes(val);
  }
  return false;
}

function showFeedback(isCorrect, explanation, correct) {
  const fb = document.getElementById('feedback-box');
  fb.className = 'feedback-box ' + (isCorrect ? 'correct' : 'wrong');
  fb.style.display = 'block';
  fb.innerHTML = `<strong>${isCorrect ? '‚úÖ Poprawnie!' : '‚ùå Niepoprawnie'}</strong>
    ${!isCorrect && correct ? `<div>Poprawna odpowied≈∫: <strong>${correct}</strong></div>` : ''}
    ${explanation ? `<div style="margin-top:0.5rem;color:var(--text-muted);font-size:0.88rem">${explanation}</div>` : ''}`;
  if (isCorrect) session.correct++; else session.wrong++;
}

function recordResult(id, isCorrect) {
  if (!state.progress[id]) state.progress[id] = { attempts: 0, correct: 0, lastSeen: null };
  state.progress[id].attempts++;
  if (isCorrect) state.progress[id].correct++;
  state.progress[id].lastSeen = new Date().toISOString();
  updateStreak();
  saveState();
}

function updateStreak() {
  const today = new Date().toDateString();
  if (state.streak.lastDate === today) return;
  const yesterday = new Date(Date.now() - 86400000).toDateString();
  if (state.streak.lastDate === yesterday) state.streak.count++;
  else state.streak.count = 1;
  state.streak.lastDate = today;
}

function nextExercise() {
  session.current++;
  renderExercise();
}

function showSessionResults() {
  const elapsed = Math.round((Date.now() - session.startTime) / 1000);
  const mins = Math.floor(elapsed / 60);
  const secs = elapsed % 60;
  const total = session.correct + session.wrong;
  const scorePct = total > 0 ? Math.round(session.correct / total * 100) : 0;

  state.history.unshift({
    date: new Date().toLocaleDateString('pl-PL'),
    category: session.category,
    score: session.correct,
    total: total,
    time: `${mins}:${secs.toString().padStart(2,'0')}`
  });
  if (state.history.length > 50) state.history = state.history.slice(0,50);
  saveState();

  const area = document.getElementById('exercise-area');
  area.innerHTML = `<div class="session-results">
    <div style="font-size:1.2rem;color:var(--text-muted)">Sesja zako≈Ñczona üéâ</div>
    <div class="session-score">${scorePct}<span>%</span></div>
    <div style="color:var(--text-muted);margin-bottom:1.5rem">${CATEGORIES[session.category]?.name || session.category}</div>
    <div class="session-breakdown">
      <div class="sb-item"><div class="sb-val" style="color:var(--success)">${session.correct}</div><div class="sb-lbl">Poprawnych</div></div>
      <div class="sb-item"><div class="sb-val" style="color:var(--error)">${session.wrong}</div><div class="sb-lbl">B≈Çƒôdnych</div></div>
      <div class="sb-item"><div class="sb-val" style="color:var(--accent2)">${mins}m ${secs}s</div><div class="sb-lbl">Czas</div></div>
    </div>
    <div class="action-row" style="justify-content:center;gap:1rem">
      <button class="btn btn-primary" onclick="startSession('${session.category}')">ƒÜwicz ponownie</button>
      <button class="btn btn-secondary" onclick="endSession()">‚Üê Kategorie</button>
      <button class="btn btn-secondary" onclick="showView('stats')">üìä Postƒôpy</button>
    </div>
  </div>`;
}

function endSession() {
  showView('home');
  renderHome();
}

// ==================== STATS ====================
function renderStats() {
  const chartEl = document.getElementById('chart-categories');
  chartEl.innerHTML = '';

  const categoryColors = Object.fromEntries(Object.entries(CATEGORIES).map(([k,v]) => [k, v.color]));

  Object.entries(CATEGORIES).forEach(([key, cat]) => {
    const catExs = state.exercises.filter(e => e.category === key);
    const attempts = catExs.reduce((a,e) => a + (state.progress[e.id]?.attempts || 0), 0);
    const correct = catExs.reduce((a,e) => a + (state.progress[e.id]?.correct || 0), 0);
    const pct = attempts > 0 ? Math.round(correct / attempts * 100) : 0;

    chartEl.innerHTML += `<div class="chart-row">
      <span class="chart-label">${cat.icon} ${cat.name}</span>
      <div class="chart-bar-wrap">
        <div class="chart-bar" style="width:${pct}%;background:${cat.color}">${pct > 10 ? pct + '%' : ''}</div>
      </div>
      <span class="chart-pct">${pct}%</span>
    </div>`;
  });

  // Weak areas
  const weakEl = document.getElementById('weak-areas');
  weakEl.innerHTML = '';
  const weakItems = Object.entries(state.progress)
    .map(([id, p]) => {
      const ex = state.exercises.find(e => e.id === id);
      const rate = p.attempts > 0 ? p.correct / p.attempts : 0;
      return { id, ex, rate, p };
    })
    .filter(x => x.ex && x.p.attempts >= 1 && x.rate < 0.6)
    .sort((a,b) => a.rate - b.rate)
    .slice(0,6);

  if (weakItems.length === 0) {
    weakEl.innerHTML = '<div style="color:var(--text-muted);font-size:0.9rem">Brak danych lub ≈õwietne wyniki üéâ ƒÜwicz wiƒôcej, aby zobaczyƒá s≈Çabe punkty.</div>';
  } else {
    weakItems.forEach(({ id, ex, rate, p }) => {
      weakEl.innerHTML += `<div class="weak-card">
        <div class="wname">${ex.question?.slice(0,60) || id}...</div>
        <div class="wstat">${p.correct}/${p.attempts} poprawnych</div>
        <div class="wpct">${Math.round(rate * 100)}% trafno≈õƒá ¬∑ ${CATEGORIES[ex.category]?.name || ex.category}</div>
      </div>`;
    });
  }

  // History
  const tbody = document.getElementById('history-tbody');
  tbody.innerHTML = '';
  if (state.history.length === 0) {
    tbody.innerHTML = '<tr><td colspan="5" style="color:var(--text-muted);text-align:center;padding:2rem">Brak historii sesji. Zacznij ƒáwiczyƒá!</td></tr>';
  } else {
    state.history.slice(0,20).forEach(h => {
      const pct = h.total > 0 ? Math.round(h.score / h.total * 100) : 0;
      const cls = pct >= 70 ? 'good' : pct >= 50 ? 'mid' : 'bad';
      tbody.innerHTML += `<tr>
        <td>${h.date}</td>
        <td>${CATEGORIES[h.category]?.name || h.category}</td>
        <td>${h.score}/${h.total}</td>
        <td>${h.time}</td>
        <td><span class="badge ${cls}">${pct}%</span></td>
      </tr>`;
    });
  }
}

// ==================== IMPORT / EXPORT ====================
function handleFileImport(event) {
  const file = event.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    document.getElementById('json-textarea').value = e.target.result;
    importJSON();
  };
  reader.readAsText(file);
}

function importJSON() {
  const raw = document.getElementById('json-textarea').value.trim();
  const msgEl = document.getElementById('import-msg');
  try {
    const data = JSON.parse(raw);
    if (!Array.isArray(data)) throw new Error('JSON musi byƒá tablicƒÖ zada≈Ñ []');
    const required = ['id','category','type'];
    const invalid = data.filter(e => !required.every(k => e[k]));
    if (invalid.length > 0) throw new Error(`${invalid.length} zada≈Ñ brakuje wymaganych p√≥l (id, category, type).`);

    const newIds = new Set(data.map(e => e.id));
    const existing = state.exercises.filter(e => !newIds.has(e.id));
    state.exercises = [...existing, ...data];
    saveState();
    msgEl.className = 'import-msg ok';
    msgEl.textContent = `‚úÖ Zaimportowano ${data.length} zada≈Ñ. ≈ÅƒÖcznie: ${state.exercises.length}.`;
  } catch (err) {
    msgEl.className = 'import-msg err';
    msgEl.textContent = '‚ùå B≈ÇƒÖd JSON: ' + err.message;
  }
}

function exportProgress() {
  const data = {
    exportDate: new Date().toISOString(),
    progress: state.progress,
    history: state.history,
    streak: state.streak
  };
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'matura-progress.json'; a.click();
  URL.revokeObjectURL(url);
}

function loadSampleData() {
  loadBuiltinExercises();
  saveState();
  const msgEl = document.getElementById('import-msg');
  msgEl.className = 'import-msg ok';
  msgEl.textContent = `‚úÖ Za≈Çadowano ${state.exercises.length} przyk≈Çadowych zada≈Ñ maturalnych.`;
  document.getElementById('json-textarea').value = JSON.stringify(state.exercises.slice(0,2), null, 2);
}

// === THEORY ===
function showTheory(section) {
  document.querySelectorAll('.theory-section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.th-nav-btn').forEach(b => b.classList.remove('active'));
  const el = document.getElementById('th-' + section);
  if (el) el.classList.add('active');
  // find the button
  document.querySelectorAll('.th-nav-btn').forEach(b => {
    if (b.getAttribute('onclick') === `showTheory('${section}')`) b.classList.add('active');
  });
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// === INIT ===
loadState();
renderHome();
</script>
</body>
</html>