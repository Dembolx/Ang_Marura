<!doctype html>
<html lang="pl">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Matura Angielski â€” Trener Pro</title>
<link rel="shortcut icon" href="assets/logo.ico" type="image/x-icon">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="style.css">

<body>
<!-- DB STATUS -->
<div id="db-status-bar" class="loading"><div class="dot"></div><span id="db-status-text">ÅÄ…czenie z bazÄ…...</span></div>

<header>
  <div class="logo">MATURA <em style="color:var(--accent)">EN</em><span id="logo-sub">Trener Angielskiego</span></div>
  <nav>
    <button class="nav-btn active" onclick="showView('home')">ğŸ  Start</button>
    <button class="nav-btn" onclick="showView('stats')">ğŸ“Š PostÄ™py</button>
    <button class="nav-btn" onclick="showView('history')">ğŸ“‹ Historia</button>
    <button class="nav-btn" onclick="showView('theory')">ğŸ“– Teoria</button>
    <button class="nav-btn" onclick="showView('import')">ğŸ“¥ Import</button>
    <button class="nav-btn" onclick="showView('db-config')">ğŸ—„ï¸ Baza</button>
  </nav>
</header>

<main>

<!-- ========== HOME VIEW ========== -->
<div id="view-home" class="view active">
  <div class="hero">
    <h1>Zdaj maturÄ™ z <em>angielskiego</em></h1>
    <p>PostÄ™py zapisywane w chmurze â€” Neon PostgreSQL</p>
  </div>

  <!-- Level switch -->
  <div class="level-switch" id="level-switch">
    <button onclick="setLevel('rozszerzony')" id="btn-lvl-r" class="active">Rozszerzony (PR)</button>
    <button onclick="setLevel('podstawowy')" id="btn-lvl-p">Podstawowy (PP)</button>
  </div>

  <div class="stats-row" id="global-stats">
    <div class="stat-card"><span class="val" id="stat-total">â€”</span><span class="lbl">ZadaÅ„ w bazie</span></div>
    <div class="stat-card"><span class="val" id="stat-done">â€”</span><span class="lbl">Zrobionych</span></div>
    <div class="stat-card"><span class="val" id="stat-score">â€”</span><span class="lbl">SkutecznoÅ›Ä‡</span></div>
    <div class="stat-card"><span class="val" id="stat-streak">â€”</span><span class="lbl">Dni z rzÄ™du ğŸ”¥</span></div>
  </div>

  <div class="categories-grid" id="categories-grid">
    <div style="grid-column:1/-1;text-align:center;color:var(--text-muted);padding:3rem 0">
      <div style="font-size:2rem;margin-bottom:.5rem">â³</div>Åadowanie kategorii...
    </div>
  </div>
</div>

<!-- ========== EXERCISE VIEW ========== -->
<div id="view-exercise" class="view">
  <div class="ex-header">
    <button class="back-btn" onclick="endSession()">â† WrÃ³Ä‡</button>
    <span class="ex-category-badge" id="ex-cat-name">â€”</span>
    <span id="ex-level-badge" class="level-badge level-r">PR</span>
    <div class="ex-progress-bar"><div class="ex-progress-fill" id="ex-progress-fill" style="width:0%"></div></div>
    <span class="ex-counter" id="ex-counter">0/0</span>
  </div>
  <div id="exercise-area"></div>
</div>

<!-- ========== STATS VIEW ========== -->
<div id="view-stats" class="view">
  <div style="font-family:'Playfair Display',serif;font-size:1.6rem;margin-bottom:1.5rem">ğŸ“Š Twoje postÄ™py</div>
  <div id="stats-content"><div style="color:var(--text-muted);text-align:center;padding:3rem">Åadowanie statystyk...</div></div>
</div>

<!-- ========== HISTORIA ZADAÅƒ VIEW ========== -->
<div id="view-history" class="view">
  <div style="font-family:'Playfair Display',serif;font-size:1.6rem;margin-bottom:.4rem">ğŸ“‹ Historia zadaÅ„</div>
  <div style="color:var(--text-muted);font-size:.85rem;margin-bottom:1.5rem">Ostatnie 30 odpowiedzi â€” sprawdÅº gdzie popeÅ‚niÅ‚eÅ› bÅ‚Ä…d</div>

  <div style="display:flex;gap:.75rem;margin-bottom:1.5rem;flex-wrap:wrap">
    <button class="btn btn-secondary" onclick="filterHistory('all')" id="hf-all" style="border-color:var(--accent);color:var(--accent)">Wszystkie</button>
    <button class="btn btn-secondary" onclick="filterHistory('wrong')" id="hf-wrong">âŒ BÅ‚Ä™dne</button>
    <button class="btn btn-secondary" onclick="filterHistory('correct')" id="hf-correct">âœ… Poprawne</button>
  </div>

  <div id="history-list"><div style="color:var(--text-muted);text-align:center;padding:3rem">Åadowanie historii...</div></div>
</div>

<!-- ========== TEORIA VIEW ========== -->
<div id="view-theory" class="view">
  <div style="font-family:'Playfair Display',serif;font-size:1.6rem;margin-bottom:.4rem">ğŸ“– Teoria i Hacki</div>
  <div style="color:var(--text-muted);font-size:.85rem;margin-bottom:1.75rem">Wszystko czego potrzebujesz do matury z angielskiego</div>

  <div id="theory-grid-wrap">
    <div class="theory-grid" id="theory-grid"></div>
  </div>
  <div id="theory-article-wrap" style="display:none">
    <button class="back-btn" style="margin-bottom:1.5rem" onclick="closeTheory()">â† PowrÃ³t do teorii</button>
    <div id="theory-article" class="theory-article active"></div>
  </div>
</div>

<!-- ========== IMPORT VIEW ========== -->
<div id="view-import" class="view">
  <div style="font-family:'Playfair Display',serif;font-size:1.6rem;margin-bottom:.4rem">ğŸ“¥ Import zadaÅ„ z JSON</div>
  <div style="color:var(--text-muted);font-size:.85rem;margin-bottom:1.75rem">Wgraj plik JSON â€” zadania zostanÄ… dodane do bazy danych</div>

  <div class="db-config">
    <h3>// 1. Wybierz ÅºrÃ³dÅ‚o</h3>
    <div style="display:flex;gap:.75rem;flex-wrap:wrap;margin-bottom:1rem">
      <label class="btn btn-primary" style="cursor:pointer;display:inline-flex;align-items:center;gap:.5rem">
        ğŸ“‚ Wczytaj plik JSON
        <input type="file" id="json-file-input" accept=".json" style="display:none" onchange="loadJSONFile(event)">
      </label>
      <button class="btn btn-secondary" onclick="toggleJSONPaste()">ğŸ“‹ Wklej JSON</button>
    </div>
    <textarea id="json-paste" class="ex-input" style="display:none;min-height:160px;font-family:'DM Mono',monospace;font-size:.78rem" placeholder='[{"id":"p001","category":"reading","level":"podstawowy",...}]' oninput="parseJSONPaste()"></textarea>
  </div>

  <div class="db-config" id="import-preview" style="display:none">
    <h3>// 2. PodglÄ…d importu</h3>
    <div id="import-summary" style="font-family:'DM Mono',monospace;font-size:.82rem;line-height:2;margin-bottom:1rem;white-space:pre"></div>
    <div id="import-table-wrap" style="overflow-x:auto;max-height:320px;overflow-y:auto"></div>
  </div>

  <div class="db-config" id="import-action" style="display:none">
    <h3>// 3. Wykonaj import</h3>
    <div style="display:flex;gap:.75rem;align-items:center;flex-wrap:wrap">
      <button class="btn btn-primary" id="push-btn" onclick="pushToDB()">ğŸš€ Push do bazy</button>
      <button class="btn btn-secondary" onclick="clearImport()">ğŸ—‘ WyczyÅ›Ä‡</button>
      <label style="display:flex;align-items:center;gap:.5rem;font-size:.85rem;color:var(--text-muted);cursor:pointer">
        <input type="checkbox" id="skip-duplicates" checked style="accent-color:var(--accent)"> PomiÅ„ duplikaty
      </label>
    </div>
    <div id="push-log" style="margin-top:1rem;font-family:'DM Mono',monospace;font-size:.78rem;line-height:1.8;max-height:200px;overflow-y:auto"></div>
  </div>
</div>

<!-- ========== DB CONFIG VIEW ========== -->
<div id="view-db-config" class="view">
  <div style="font-family:'Playfair Display',serif;font-size:1.6rem;margin-bottom:.4rem">ğŸ—„ï¸ Konfiguracja Bazy</div>
  <div style="color:var(--text-muted);font-size:.85rem;margin-bottom:1.75rem">Neon PostgreSQL â€” Serverless Driver</div>

  <div class="db-config">
    <h3>// Dane poÅ‚Ä…czenia</h3>
    <div style="font-family:'DM Mono',monospace;font-size:.78rem;color:var(--text-muted);margin-bottom:1rem;line-height:1.7">
      Host: <span style="color:var(--accent2)">ep-old-moon-agtpam3x-pooler.c-2.eu-central-1.aws.neon.tech</span><br>
      Baza: <span style="color:var(--accent2)">neondb</span>
    </div>
    <label style="font-size:.82rem;color:var(--text-muted);display:block;margin-bottom:.25rem">User ID</label>
    <input class="db-input" id="cfg-user" type="text" placeholder="np. jan_kowalski"/>
    <div style="display:flex;gap:.75rem;margin-top:.5rem;flex-wrap:wrap">
      <button class="btn btn-primary" onclick="saveConfig()">ğŸ’¾ Zapisz</button>
      <button class="btn btn-secondary" onclick="testConnection()">ğŸ”Œ Test</button>
      <button class="btn btn-secondary" onclick="resetProgress()">ğŸ—‘ Reset postÄ™pÃ³w</button>
    </div>
    <div id="cfg-msg" style="margin-top:.75rem;font-size:.85rem"></div>
  </div>

  <div class="db-config">
    <h3>// Status</h3>
    <div id="conn-details" style="font-family:'DM Mono',monospace;font-size:.78rem;color:var(--text-muted);line-height:1.8">Kliknij Test poÅ‚Ä…czenia.</div>
  </div>

  <div class="db-config">
    <h3>// Ostatnie 10 sesji</h3>
    <div id="session-history-list" style="color:var(--text-muted);font-size:.85rem">Åadowanie...</div>
  </div>
</div>

</main>
<script src="script.js"></script>
</body>
</html>